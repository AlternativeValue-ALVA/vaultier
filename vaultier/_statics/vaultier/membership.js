Vaultier.InvitationUseRoute=Ember.Route.extend({invitations:null,model:function(t,n){return n.abort(),this.get("invitations").useInvitation(t.invitation,t.hash,t.data)}}),Vaultier.InvitationAcceptRoute=Ember.Route.extend({invitations:null,model:function(t,n){var e=this.get("invitations"),i=e.fetchInvitationsInSession().catch(function(t){if(n.abort(),e.clearInvitationsInSession(),!(t&&400==t.status&&t.errors&&t.errors.hash||t&&404==t.status))throw new Error("Invalid invitation");this.get("errors").consoleError(t),this.get("errors").renderError({title:"Invalid invitation.",message:"this invitation cannot be used. Not found or it was already used by other member"})}.bind(this));return i},setupController:function(t,n){t.set("content",n);var e=this.get("environment");t.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:e}).addHome().addText("List of invitations to accept"))},actions:{acceptInvitations:function(){var t=this.get("controller.content"),n=this.get("invitations"),e=n.acceptInvitationsInSession(t).then(function(){n.clearInvitationsInSession(),$.notify("You have accepted your invitations","success"),this.transitionTo("index")}.bind(this));ApplicationLoader.promise(e)},rejectInvitations:function(){var t=this.get("invitations");t.clearInvitationsInSession(),$.notify("You have rejected your pending invitations","warning"),this.transitionTo("index")}}}),Vaultier.InvitationAnonymousRoute=Ember.Route.extend({setupController:function(t,n){t.set("content",n);var e=this.get("environment");t.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:e}).addHome().addText("Accept invitation"))}}),Vaultier.InvitationAcceptView=Ember.View.extend({templateName:"Invitation/InvitationAccept",layoutName:"Layout/LayoutStandard"}),Vaultier.InvitationListView=Ember.View.extend({templateName:"Invitation/InvitationList",layoutName:"Layout/LayoutStandard"}),Vaultier.InvitationAnonymousView=Ember.View.extend({templateName:"Invitation/InvitationAnonymous",layoutName:"Layout/LayoutStandard"});
Vaultier.MemberInviteInput=Ember.Component.extend({classNames:["vaultier-member-invite-input"],value:null,store:null,auth:null,workspace:null,tagName:"input",didInsertElement:function(){function e(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}if(!this.store)throw"MemberInviteInput requires store to autocomplete. Inject store to component as store=store";if(!this.workspace)throw"MemberInviteInput requires workspace to autocomplete. Inject workspace to component as workspace=workspace";if(!this.auth)throw"MemberInviteInput requires auth service to autocomplete. Inject auth to component as auth=auth";var t=Ember.$(this.get("element")),i={},n=function(){this.store.find("Member",{workspace:Utils.E.recordId(this.workspace),search:this.query.term,ordering:"-status"}).then(function(e){var t=[];e.forEach(function(e){var i=e.get("status")==e.statuses.INVITED.value;e.get("user")!=this.auth.get("user.id")&&t.push({invitation:i,text:e.get("email"),id:e.get(i?"email":"id"),nickname:e.get("nickname"),email:e.get("email")})}.bind(this)),this.query.callback({results:t})}.bind(this))};t.select2({tokenSeparators:[","," ",";"],createSearchChoice:function(t,i){var n=!0;return i.forEach(function(e){return t==e.id?(n=!1,!1):void 0}),e(t)||(n=!1),n?{invitation:!0,text:t,nickname:t,email:t.toLowerCase(),id:t.toLowerCase()}:void 0},multiple:!0,query:function(e){i.store=this.get("controller.store"),i.query=e,i.auth=this.get("auth"),i.workspace=this.get("workspace"),Ember.run.debounce(i,n,500)}.bind(this),formatResult:function(e){var t=Utils.HandlebarsHelpers.current().printUser(e,{hash:{disableTooltip:!0}});return t=e.invitation?"Invite <b>"+t+"</b>":"grant to <b>"+t+"</b>"},formatSelection:function(e){var t=Utils.HandlebarsHelpers.current().printUser(e,{hash:{disableTooltip:!0}});return t=e.invitation?"Invite <b>"+t+"</b>":"grant to <b>"+t+"</b>"}}),t.on("change",function(e){this.set("value",e.val)}.bind(this))}}),Vaultier.MemberSelectRoleView=Ember.Select.extend({willDestroyElement:function(){var e=$(this.get("element")),t=e[0].selectize;t.destroy()},didInsertElement:function(){var e=$(this.get("element"));e.selectize({create:!1,highlight:!1,render:{option:function(e){var e=Vaultier.Role.proto().roles.getByValue(e.value);return["<div>","<div>"+e.text+"</div>",'<div class="help-block">'+e.desc+"</div>","</div>"].join("")}.bind(this)}});var t=e[0].selectize;t.setValue(this.get("role.level")),t.on("dropdown_close",function(){t.getValue()||t.setValue(this.get("role.level"))}.bind(this)),t.on("change",function(e){e&&(this.set("role.level",e),this.send("changed",e))}.bind(this))}});
Vaultier.MemberIndexRoute=Ember.Route.extend({inviteObject:null,model:function(e,t){if(this.setProperties(this.setupInviteData(e)),this.get("auth").checkPermissions(t,function(){return this.get("inviteObject.perms.invite")}.bind(this),!0)){var r=this.setupBlocks(),o=this.modelFor("Workspace"),s=this.modelFor("Vault"),n=this.modelFor("Card"),i=this.get("store"),l={workspace:null,workspaceRoles:null,vault:null,vaultRoles:null,card:null,cardRoles:null};r.workspace&&(l.workspace=o,l.workspaceRoles=i.find("Role",{to_workspace:o.get("id")})),r.vault&&(l.vault=s,l.vaultRoles=i.find("Role",{to_vault:s.get("id")})),r.card&&(l.card=n,l.cardRoles=i.find("Role",{to_card:n.get("id")}));var a=Ember.RSVP.hash(l);return a}},setupBlocks:function(){throw"Please override this in your route"},setupInviteRoute:function(){throw"Please override this in your route"},setupInviteData:function(){throw"Please override this in your route"},setupRoleLevels:function(){return Vaultier.Role.proto().roles.toArray()},setupBreadcrumbs:function(){throw"Please override this in your route"},setupController:function(e,t){var r=[];t.card&&r.push(Ember.Object.create({url:null,type:"card",object:t.card,roles:t.cardRoles})),t.vault&&r.push(Ember.Object.create({type:"vault",url:this.get("router").generate("Vault.memberIndex",t.vault),object:t.vault,roles:t.vaultRoles})),t.workspace&&r.push(Ember.Object.create({type:"workspace",url:this.get("router").generate("Workspace.memberIndex",t.workspace),object:t.workspace,roles:t.workspaceRoles})),e.set("content",r),e.set("roleLevels",this.setupRoleLevels()),e.setProperties(this.setupInviteRoute(t)),e.set("breadcrumbs",this.setupBreadcrumbs(t))},renderTemplate:function(){this.render("MemberIndex",{controller:this.get("controller")})},actions:{deleteRole:function(e,t){Vaultier.confirmModal(this,"Are you sure?",function(){var r=e.deleteRecord().then(function(){t.roles.removeObject(e),$.notify("User 's permission has been removed.","success")}).catch(function(e){$.notify("Oooups! Something went wrong.","error"),this.get("errors").logError(e)}.bind(this));ApplicationLoader.promise(r)})},changeRole:function(e){var t=e.saveRecord().then(function(){$.notify("User 's permission has been updated.","success")}).catch(function(e){$.notify("Oooups! Something went wrong.","error"),this.get("errors").logError(e)}.bind(this));ApplicationLoader.promise(t)}}}),Vaultier.MemberIndexController=Ember.Controller.extend({blocks:function(){var e=0;return this.get("content").map(function(t,r){var o=0===t.roles.get("length")&&r>0;o||e++;var s=!o&&2===e;return t.setProperties({index:r,isSecond:s,isHidden:o,readOnly:r>0}),t})}.property("content.@each")}),Vaultier.MemberIndexView=Ember.View.extend({templateName:"Member/MemberIndex",layoutName:"Layout/LayoutStandard",Item:Ember.View.extend({tagName:"div",Select:Vaultier.MemberSelectRoleView.extend({actions:{changed:function(){this.get("controller").send("changeRole",this.get("role"),this.get("block"))}}})})});
Vaultier.MemberInviteRoute=Ember.Route.extend({inviteObject:null,model:function(e,t){this.setProperties(this.setupInviteData(e)),!this.get("auth").checkPermissions(t,function(){return this.get("inviteObject.perms.invite")}.bind(this),!0)},setupInviteData:function(){throw"Please override this in your route"},setupBreadcrumbs:function(){throw"Please override this in your route"},setupRoleLevels:function(){return Vaultier.Role.proto().roles.toArray()},getDefaultRoleLevel:function(){return Vaultier.Role.proto().roles.READ.value},actions:{save:function(e,t,r){var i=this.get("invitations"),n=this.get("inviteWorkspace"),o=this.get("inviteParams"),l=[];e.forEach(function(e){l.push(i.invite(n,e,t.level,o,!0,r))});var s=Ember.RSVP.all(l).then(function(){$.notify("Your invitations has been saved","success"),window.history.go(-1)}).catch(function(){$.notify("Oooups! Something went wrong.","error")});return ApplicationLoader.promise(s),s}},setupController:function(e){e.set("workspace",this.modelFor("Workspace")),e.set("breadcrumbs",this.setupBreadcrumbs()),e.set("invited",[]),e.set("role",{level:this.getDefaultRoleLevel()}),e.set("roleLevels",this.setupRoleLevels())},renderTemplate:function(){this.render("MemberInvite",{controller:this.get("controller")})}}),Vaultier.MemberInviteController=Ember.Controller.extend({workspace:null,role:null,invited:[],resend:!0,isSubmitDisabled:function(){return!this.get("invited.length")||!this.get("role.level")}.property("invited.length","role.level"),breadcrumbs:null}),Vaultier.MemberInviteView=Ember.View.extend({templateName:"Member/MemberInvite",layoutName:"Layout/LayoutStandard",Select:Vaultier.MemberSelectRoleView});
Vaultier.MemberBoxComponent=Ember.Component.extend({layoutName:"Member/MemberBox",init:function(){this._super.apply(this,arguments),this.checkParameters()},checkParameters:function(){var e=this.get("roles"),r=this.get("user");if("[object Array]"!=Object.prototype.toString.call(e))throw new Error("Roles array has to be passed as roles=[Vaultier.Role] parameter");if(!r||r.constructor!=Vaultier.User)throw new Error("Current user has to be passed as user=Vaultier.User")},processedRoles:function(){var e=this.get("roles").filter(function(e){return e.get("member.user")!=this.get("user.id")?e:void 0}.bind(this));e=e.sort(function(e,r){return r.get("level")-e.get("level")});var r=[];return e=e.filter(function(e){var t=e.get("member.id");return-1==r.indexOf(t)?(r.push(t),e):void 0})}.property("roles"),hasAny:function(){return this.get("processedRoles").length>0?!0:!1}.property("processedRoles"),hasRead:function(){return 0!=this.get("rolesRead").length}.property("rolesRead"),rolesRead:function(){return this.get("processedRoles").filter(function(e){return e.get("level")==Vaultier.Role.proto().roles.READ.value?e:void 0})}.property("processedRoles"),hasCreate:function(){return 0!=this.get("rolesCreate").length}.property("rolesCreate"),rolesCreate:function(){return this.get("processedRoles").filter(function(e){return e.get("level")==Vaultier.Role.proto().roles.CREATE.value?e:void 0})}.property("processedRoles"),hasWrite:function(){return 0!=this.get("rolesWrite").length}.property("rolesWrite"),rolesWrite:function(){return this.get("processedRoles").filter(function(e){return e.get("level")==Vaultier.Role.proto().roles.WRITE.value?e:void 0})}.property("processedRoles")});
"use strict";Vaultier.MemberManagementRoute=Vaultier.MemberIndexRoute.extend({model:function(e){this.setProperties(this.setupInviteData(e));var t=this.modelFor("Workspace"),r=this.get("store"),n=r.find("Member",{workspace:t.get("id")}).then(function(e){return Em.ArrayProxy.create({content:e})}),o={workspace:t,members:n};return Ember.RSVP.hash(o)},setupController:function(e,t){e.set("content",t),e.set("breadcrumbs",this.setupBreadcrumbs(t))},renderTemplate:function(){this.render("MemberManagement",{controller:this.get("controller")})},actions:{deleteRole:function(e,t){Vaultier.confirmModal(this,"Are you sure you want to delete this permission?",function(){var r=t.deleteRecord().then(function(){var r=e.get("roles");r.removeObject(t),$.notify("Role has been remove","success")}.bind(this)).catch(function(e){$.notify("Oooups! Something went wrong.","error"),this.get("errors").logError(e)}.bind(this));ApplicationLoader.promise(r)})},loadRoles:function(e,t){var r=(e.get("roles"),this.get("store")),n=r.find("Role",{to_workspace:t.get("workspace"),to_member:t.get("id")}).then(function(t){var r=Em.ArrayProxy.create({content:t}).toArray();return e.set("roles",r),r}.bind(this));ApplicationLoader.promise(n)},deleteMember:function(e,t){Vaultier.confirmModal(this,"Are you sure you want to delete this member?",function(){var r=t.deleteRecord().then(function(){var r=e.get("members");r.removeObject(t),$.notify("Member has been remove","success")}.bind(this)).catch(function(e){$.notify("Oooups! Something went wrong.","error"),this.get("errors").logError(e)}.bind(this));ApplicationLoader.promise(r)})}}}),Vaultier.MemberManagementController=Vaultier.MemberIndexController.extend({members:function(){var e=this.get("auth.user");return this.get("content.members").filter(function(t){return t.get("email")!==e.get("email")}).toArray()}.property("content.@each")}),Vaultier.MemberManagementView=Vaultier.MemberIndexView.extend({templateName:"Member/MemberManagement"}),Vaultier.MemberManagerAccordionComponent=Em.Component.extend({store:null,layoutName:"Member/MemberManagerAccordion",buildId:function(e){return e=e.replace(/[@\.]/g," "),Em.String.dasherize(e)+"-roles"},targetElement:function(){var e=this.buildId(this.get("member.nickname"));return"#"+e}.property(),id:function(){return this.buildId(this.get("member.nickname"))}.property(),roles:null,control:null,member:null,roleLevels:function(){return Vaultier.Role.proto().roles.toArray()}.property("content.@each"),actions:{loadRoles:function(){this.sendAction("loadRoles",this.get("context"),this.get("member"))},deleteRole:function(e){this.sendAction("deleteRole",this.get("context"),e)},deleteMember:function(e){this.sendAction("deleteMember",this.get("context"),e)}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkludml0YXRpb24uanMiLCJNZW1iZXJJbnZpdGVJbnB1dC5qcyIsIk1lbWJlckluZGV4LmpzIiwiTWVtYmVySW52aXRlLmpzIiwiTWVtYmVyQm94LmpzIiwiTWVtYmVyTWFuYWdlbWVudC5qcyJdLCJuYW1lcyI6WyJWYXVsdGllciIsIkludml0YXRpb25Vc2VSb3V0ZSIsIkVtYmVyIiwiUm91dGUiLCJleHRlbmQiLCJpbnZpdGF0aW9ucyIsIm1vZGVsIiwicGFyYW1zIiwidHJhbnNpdGlvbiIsImFib3J0IiwidGhpcyIsImdldCIsInVzZUludml0YXRpb24iLCJpbnZpdGF0aW9uIiwiaGFzaCIsImRhdGEiLCJJbnZpdGF0aW9uQWNjZXB0Um91dGUiLCJwcm9taXNlIiwiZmV0Y2hJbnZpdGF0aW9uc0luU2Vzc2lvbiIsImNhdGNoIiwiZXJyb3IiLCJjbGVhckludml0YXRpb25zSW5TZXNzaW9uIiwic3RhdHVzIiwiZXJyb3JzIiwiRXJyb3IiLCJjb25zb2xlRXJyb3IiLCJyZW5kZXJFcnJvciIsInRpdGxlIiwibWVzc2FnZSIsImJpbmQiLCJzZXR1cENvbnRyb2xsZXIiLCJjdHJsIiwic2V0IiwiZW52aXJvbm1lbnQiLCJCcmVhZGNydW1icyIsImNyZWF0ZSIsInJvdXRlciIsImFkZEhvbWUiLCJhZGRUZXh0IiwiYWN0aW9ucyIsImFjY2VwdEludml0YXRpb25zIiwic2VydmljZSIsImFjY2VwdEludml0YXRpb25zSW5TZXNzaW9uIiwidGhlbiIsIiQiLCJub3RpZnkiLCJ0cmFuc2l0aW9uVG8iLCJBcHBsaWNhdGlvbkxvYWRlciIsInJlamVjdEludml0YXRpb25zIiwiSW52aXRhdGlvbkFub255bW91c1JvdXRlIiwiSW52aXRhdGlvbkFjY2VwdFZpZXciLCJWaWV3IiwidGVtcGxhdGVOYW1lIiwibGF5b3V0TmFtZSIsIkludml0YXRpb25MaXN0VmlldyIsIkludml0YXRpb25Bbm9ueW1vdXNWaWV3IiwiTWVtYmVySW52aXRlSW5wdXQiLCJDb21wb25lbnQiLCJjbGFzc05hbWVzIiwidmFsdWUiLCJzdG9yZSIsImF1dGgiLCJ3b3Jrc3BhY2UiLCJ0YWdOYW1lIiwiZGlkSW5zZXJ0RWxlbWVudCIsInZhbGlkYXRlRW1haWwiLCJlbWFpbCIsInJlIiwidGVzdCIsImVsIiwiYWpheFF1ZXJ5Q29udGV4dCIsImFqYXhRdWVyeSIsImZpbmQiLCJVdGlscyIsIkUiLCJyZWNvcmRJZCIsInNlYXJjaCIsInF1ZXJ5IiwidGVybSIsIm9yZGVyaW5nIiwibWVtYmVycyIsInJlc3VsdHMiLCJmb3JFYWNoIiwibWVtYmVyIiwic3RhdHVzZXMiLCJwdXNoIiwidGV4dCIsImlkIiwibmlja25hbWUiLCJjYWxsYmFjayIsInNlbGVjdDIiLCJ0b2tlblNlcGFyYXRvcnMiLCJjcmVhdGVTZWFyY2hDaG9pY2UiLCJhZGQiLCJ0b0xvd2VyQ2FzZSIsIm11bHRpcGxlIiwicnVuIiwiZGVib3VuY2UiLCJmb3JtYXRSZXN1bHQiLCJzdHIiLCJIYW5kbGViYXJzSGVscGVycyIsImN1cnJlbnQiLCJwcmludFVzZXIiLCJkaXNhYmxlVG9vbHRpcCIsImZvcm1hdFNlbGVjdGlvbiIsIm9uIiwiZSIsInZhbCIsIk1lbWJlclNlbGVjdFJvbGVWaWV3IiwiU2VsZWN0Iiwid2lsbERlc3Ryb3lFbGVtZW50Iiwic2VsZWN0aXplIiwiZGVzdHJveSIsImhpZ2hsaWdodCIsInJlbmRlciIsIm9wdGlvbiIsIml0ZW0iLCJSb2xlIiwicHJvdG8iLCJyb2xlcyIsImdldEJ5VmFsdWUiLCJkZXNjIiwiam9pbiIsInNldFZhbHVlIiwiZ2V0VmFsdWUiLCJzZW5kIiwiTWVtYmVySW5kZXhSb3V0ZSIsImludml0ZU9iamVjdCIsInNldFByb3BlcnRpZXMiLCJzZXR1cEludml0ZURhdGEiLCJjaGVja1Blcm1pc3Npb25zIiwiYmxvY2tzIiwic2V0dXBCbG9ja3MiLCJtb2RlbEZvciIsInZhdWx0IiwiY2FyZCIsInF1ZXJpZXMiLCJ3b3Jrc3BhY2VSb2xlcyIsInZhdWx0Um9sZXMiLCJjYXJkUm9sZXMiLCJ0b193b3Jrc3BhY2UiLCJ0b192YXVsdCIsInRvX2NhcmQiLCJtb2RlbHMiLCJSU1ZQIiwic2V0dXBJbnZpdGVSb3V0ZSIsInNldHVwUm9sZUxldmVscyIsInRvQXJyYXkiLCJzZXR1cEJyZWFkY3J1bWJzIiwiT2JqZWN0IiwidXJsIiwidHlwZSIsIm9iamVjdCIsImdlbmVyYXRlIiwicmVuZGVyVGVtcGxhdGUiLCJjb250cm9sbGVyIiwiZGVsZXRlUm9sZSIsInJvbGUiLCJibG9jayIsImNvbmZpcm1Nb2RhbCIsImRlbGV0ZVJlY29yZCIsInJlbW92ZU9iamVjdCIsImxvZ0Vycm9yIiwiY2hhbmdlUm9sZSIsInNhdmVSZWNvcmQiLCJNZW1iZXJJbmRleENvbnRyb2xsZXIiLCJDb250cm9sbGVyIiwic2hvd25JbmRleCIsIm1hcCIsImluZGV4IiwiaXNIaWRkZW4iLCJpc1NlY29uZCIsInJlYWRPbmx5IiwicHJvcGVydHkiLCJNZW1iZXJJbmRleFZpZXciLCJJdGVtIiwiY2hhbmdlZCIsIk1lbWJlckludml0ZVJvdXRlIiwiZ2V0RGVmYXVsdFJvbGVMZXZlbCIsInNhdmUiLCJpbnZpdGVkIiwicmVzZW5kIiwiaW52aXRlV29ya3NwYWNlIiwiaW52aXRlUGFyYW1zIiwiaW52aXRlZFByb21pc2VzIiwiZW1haWxPcklkIiwiaW52aXRlIiwibGV2ZWwiLCJidWxrIiwiYWxsIiwid2luZG93IiwiaGlzdG9yeSIsImdvIiwiTWVtYmVySW52aXRlQ29udHJvbGxlciIsImlzU3VibWl0RGlzYWJsZWQiLCJicmVhZGNydW1icyIsIk1lbWJlckludml0ZVZpZXciLCJNZW1iZXJCb3hDb21wb25lbnQiLCJpbml0IiwiX3N1cGVyIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJjaGVja1BhcmFtZXRlcnMiLCJ1c2VyIiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiY29uc3RydWN0b3IiLCJVc2VyIiwicHJvY2Vzc2VkUm9sZXMiLCJmaWx0ZXIiLCJzb3J0IiwiYSIsImIiLCJmb3VuZFJvbGVzIiwiaW5kZXhPZiIsImhhc0FueSIsImxlbmd0aCIsImhhc1JlYWQiLCJyb2xlc1JlYWQiLCJoYXNDcmVhdGUiLCJyb2xlc0NyZWF0ZSIsImhhc1dyaXRlIiwicm9sZXNXcml0ZSIsIk1lbWJlck1hbmFnZW1lbnRSb3V0ZSIsInJlc3BvbnNlIiwiRW0iLCJBcnJheVByb3h5IiwiY29udGVudCIsImNvbnRleHQiLCJsb2FkUm9sZXMiLCJ0b19tZW1iZXIiLCJtZW1iZXJSb2xlcyIsImRlbGV0ZU1lbWJlciIsIk1lbWJlck1hbmFnZW1lbnRDb250cm9sbGVyIiwiTWVtYmVyTWFuYWdlbWVudFZpZXciLCJNZW1iZXJNYW5hZ2VyQWNjb3JkaW9uQ29tcG9uZW50IiwiYnVpbGRJZCIsInJlcGxhY2UiLCJTdHJpbmciLCJkYXNoZXJpemUiLCJ0YXJnZXRFbGVtZW50IiwiY29udHJvbCIsInJvbGVMZXZlbHMiLCJzZW5kQWN0aW9uIl0sIm1hcHBpbmdzIjoiQUFBQUEsU0FBU0MsbUJBQXFCQyxNQUFNQyxNQUFNQyxRQU1sQ0MsWUFBYSxLQUViQyxNQUFPLFNBQVVDLEVBQVFDLEdBRXJCLE1BREFBLEdBQVdDLFFBQ0pDLEtBQUtDLElBQUksZUFBZUMsY0FBY0wsRUFBT00sV0FBWU4sRUFBT08sS0FBTVAsRUFBT1EsU0FLaEdmLFNBQVNnQixzQkFBd0JkLE1BQU1DLE1BQU1DLFFBTXJDQyxZQUFhLEtBRWJDLE1BQU8sU0FBVUMsRUFBUUMsR0FDckIsR0FBSUgsR0FBY0ssS0FBS0MsSUFBSSxlQUN2Qk0sRUFBVVosRUFDVGEsNEJBQ0FDLE1BQU0sU0FBVUMsR0FJYixHQUhBWixFQUFXQyxRQUNYSixFQUFZZ0IsOEJBR1BELEdBQXlCLEtBQWhCQSxFQUFNRSxRQUFpQkYsRUFBTUcsUUFBVUgsRUFBTUcsT0FBT1QsTUFDMURNLEdBQXlCLEtBQWhCQSxFQUFNRSxRQVFuQixLQUFNLElBQUlFLE9BQU0scUJBTmhCZCxNQUFLQyxJQUFJLFVBQVVjLGFBQWFMLEdBQ2hDVixLQUFLQyxJQUFJLFVBQVVlLGFBQ2ZDLE1BQU8sc0JBQ1BDLFFBQVMsc0ZB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T0EsR0FBS3pHLElBQUksV0FBYWdNLEVBQUtoTSxJQUFJLFdBRTVDd0ksV0FDSjBCLFNBQVMsbUJBSWY3SyxTQUFTMk8scUJBQXVCM08sU0FBUzhLLGdCQUFnQjFLLFFBQ3JEZ0QsYUFBYyw0QkFJbEJwRCxTQUFTNE8sZ0NBQWtDVixHQUFHekssVUFBVXJELFFBQ3BEd0QsTUFBTyxLQUNQUCxXQUFZLGdDQUNad0wsUUFBUyxTQUFVMUksR0FFZixNQURBQSxHQUFNQSxFQUFJMkksUUFBUSxTQUFVLEtBQ3JCWixHQUFHYSxPQUFPQyxVQUFVN0ksR0FBTyxVQUV0QzhJLGNBQWUsV0FDWCxHQUFJOUksR0FBTXpGLEtBQUttTyxRQUFRbk8sS0FBS0MsSUFBSSxtQkFDaEMsT0FBTyxJQUFNd0YsR0FDZjBFLFdBQ0Z0RixHQUFJLFdBQ0EsTUFBTzdFLE1BQUttTyxRQUFRbk8sS0FBS0MsSUFBSSxxQkFDL0JrSyxXQUNGdEQsTUFBTyxLQUNQMkgsUUFBUyxLQUNUL0osT0FBUSxLQUNSZ0ssV0FBWSxXQUNSLE1BQU9uUCxVQUFTcUgsS0FBS0MsUUFBUUMsTUFBTTRCLFdBQ3JDMEIsU0FBUyxpQkFDWHRJLFNBRUkrTCxVQUFXLFdBQ1A1TixLQUFLME8sV0FBVyxZQUFhMU8sS0FBS0MsSUFBSSxXQUFZRCxLQUFLQyxJQUFJLFlBRS9EaUosV0FBWSxTQUFVQyxHQUNsQm5KLEtBQUswTyxXQUFXLGFBQWMxTyxLQUFLQyxJQUFJLFdBQVlrSixJQUV2RDRFLGFBQWMsU0FBVXRKLEdBQ3BCekUsS0FBSzBPLFdBQVcsZUFBZ0IxTyxLQUFLQyxJQUFJLFdBQVl3RSIsImZpbGUiOiJtZW1iZXJzaGlwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiVmF1bHRpZXIuSW52aXRhdGlvblVzZVJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKFxyXG4gICAge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAREkgc2VydmljZTppbnZpdGF0aW9uc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGludml0YXRpb25zOiBudWxsLFxyXG5cclxuICAgICAgICBtb2RlbDogZnVuY3Rpb24gKHBhcmFtcywgdHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uLmFib3J0KCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldCgnaW52aXRhdGlvbnMnKS51c2VJbnZpdGF0aW9uKHBhcmFtcy5pbnZpdGF0aW9uLCBwYXJhbXMuaGFzaCwgcGFyYW1zLmRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcblZhdWx0aWVyLkludml0YXRpb25BY2NlcHRSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChcclxuICAgIHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQERJIHNlcnZpY2U6aW52aXRhdGlvbnNcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnZpdGF0aW9uczogbnVsbCxcclxuXHJcbiAgICAgICAgbW9kZWw6IGZ1bmN0aW9uIChwYXJhbXMsIHRyYW5zaXRpb24pIHtcclxuICAgICAgICAgICAgdmFyIGludml0YXRpb25zID0gdGhpcy5nZXQoJ2ludml0YXRpb25zJyk7XHJcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gaW52aXRhdGlvbnNcclxuICAgICAgICAgICAgICAgIC5mZXRjaEludml0YXRpb25zSW5TZXNzaW9uKClcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uLmFib3J0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52aXRhdGlvbnMuY2xlYXJJbnZpdGF0aW9uc0luU2Vzc2lvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvciAmJiBlcnJvci5zdGF0dXMgPT0gNDAwICYmIGVycm9yLmVycm9ycyAmJiBlcnJvci5lcnJvcnMuaGFzaCkgLy8gYWxyZWFkeSBhY2NlcHRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCAoZXJyb3IgJiYgZXJyb3Iuc3RhdHVzID09IDQwNCkgLy8gbm90IGZvdW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldCgnZXJyb3JzJykuY29uc29sZUVycm9yKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldCgnZXJyb3JzJykucmVuZGVyRXJyb3Ioe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdJbnZhbGlkIGludml0YXRpb24uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICd0aGlzIGludml0YXRpb24gY2Fubm90IGJlIHVzZWQuIE5vdCBmb3VuZCBvciBpdCB3YXMgYWxyZWFkeSB1c2VkIGJ5IG90aGVyIG1lbWJlcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGludml0YXRpb24nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNldHVwQ29udHJvbGxlcjogZnVuY3Rpb24gKGN0cmwsIG1vZGVsKSB7XHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdjb250ZW50JywgbW9kZWwpO1xyXG4gICAgICAgICAgICB2YXIgZW52aXJvbm1lbnQgPSB0aGlzLmdldCgnZW52aXJvbm1lbnQnKTtcclxuICAgICAgICAgICAgY3RybC5zZXQoJ2JyZWFkY3J1bWJzJyxcclxuICAgICAgICAgICAgICAgIFZhdWx0aWVyLkJyZWFkY3J1bWJzLmNyZWF0ZSh7cm91dGVyOiB0aGlzLmdldCgncm91dGVyJyksIGVudmlyb25tZW50OiBlbnZpcm9ubWVudH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZEhvbWUoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRUZXh0KCdMaXN0IG9mIGludml0YXRpb25zIHRvIGFjY2VwdCcpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWN0aW9uczoge1xyXG4gICAgICAgICAgICBhY2NlcHRJbnZpdGF0aW9uczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGludml0YXRpb25zID0gdGhpcy5nZXQoJ2NvbnRyb2xsZXIuY29udGVudCcpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB0aGlzLmdldCgnaW52aXRhdGlvbnMnKTtcclxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gc2VydmljZS5hY2NlcHRJbnZpdGF0aW9uc0luU2Vzc2lvbihpbnZpdGF0aW9ucykuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2UuY2xlYXJJbnZpdGF0aW9uc0luU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnWW91IGhhdmUgYWNjZXB0ZWQgeW91ciBpbnZpdGF0aW9ucycsICdzdWNjZXNzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvblRvKCdpbmRleCcpXHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgcmVqZWN0SW52aXRhdGlvbnM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbnZpdGF0aW9ucyA9IHRoaXMuZ2V0KCdpbnZpdGF0aW9ucycpO1xyXG4gICAgICAgICAgICAgICAgaW52aXRhdGlvbnMuY2xlYXJJbnZpdGF0aW9uc0luU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICAgICAgJC5ub3RpZnkoJ1lvdSBoYXZlIHJlamVjdGVkIHlvdXIgcGVuZGluZyBpbnZpdGF0aW9ucycsICd3YXJuaW5nJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25UbygnaW5kZXgnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5WYXVsdGllci5JbnZpdGF0aW9uQW5vbnltb3VzUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoXHJcbiAgICB7XHJcbiAgICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbiAoY3RybCwgbW9kZWwpIHtcclxuICAgICAgICAgICAgY3RybC5zZXQoJ2NvbnRlbnQnLCBtb2RlbCk7XHJcbiAgICAgICAgICAgIHZhciBlbnZpcm9ubWVudCA9IHRoaXMuZ2V0KCdlbnZpcm9ubWVudCcpO1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnYnJlYWRjcnVtYnMnLFxyXG4gICAgICAgICAgICAgICAgVmF1bHRpZXIuQnJlYWRjcnVtYnMuY3JlYXRlKHtyb3V0ZXI6IHRoaXMuZ2V0KCdyb3V0ZXInKSwgZW52aXJvbm1lbnQ6IGVudmlyb25tZW50fSlcclxuICAgICAgICAgICAgICAgICAgICAuYWRkSG9tZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFRleHQoJ0FjY2VwdCBpbnZpdGF0aW9uJylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG5WYXVsdGllci5JbnZpdGF0aW9uQWNjZXB0VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcclxuICAgIHRlbXBsYXRlTmFtZTogJ0ludml0YXRpb24vSW52aXRhdGlvbkFjY2VwdCcsXHJcbiAgICBsYXlvdXROYW1lOiAnTGF5b3V0L0xheW91dFN0YW5kYXJkJ1xyXG59KTtcclxuXHJcblZhdWx0aWVyLkludml0YXRpb25MaXN0VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcclxuICAgIHRlbXBsYXRlTmFtZTogJ0ludml0YXRpb24vSW52aXRhdGlvbkxpc3QnLFxyXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCdcclxufSk7XHJcblxyXG5cclxuVmF1bHRpZXIuSW52aXRhdGlvbkFub255bW91c1ZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdJbnZpdGF0aW9uL0ludml0YXRpb25Bbm9ueW1vdXMnLFxyXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCdcclxufSk7XHJcbiIsIlZhdWx0aWVyLk1lbWJlckludml0ZUlucHV0ID0gRW1iZXIuQ29tcG9uZW50LmV4dGVuZCh7XHJcbiAgICBjbGFzc05hbWVzOiBbJ3ZhdWx0aWVyLW1lbWJlci1pbnZpdGUtaW5wdXQnXSxcclxuXHJcbiAgICB2YWx1ZTogbnVsbCxcclxuXHJcbiAgICBzdG9yZTogbnVsbCxcclxuXHJcbiAgICBhdXRoOiBudWxsLFxyXG5cclxuICAgIHdvcmtzcGFjZTogbnVsbCxcclxuXHJcbiAgICB0YWdOYW1lOiBcImlucHV0XCIsXHJcblxyXG4gICAgZGlkSW5zZXJ0RWxlbWVudDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuc3RvcmUpIHtcclxuICAgICAgICAgICAgdGhyb3cgJ01lbWJlckludml0ZUlucHV0IHJlcXVpcmVzIHN0b3JlIHRvIGF1dG9jb21wbGV0ZS4gSW5qZWN0IHN0b3JlIHRvIGNvbXBvbmVudCBhcyBzdG9yZT1zdG9yZSdcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLndvcmtzcGFjZSkge1xyXG4gICAgICAgICAgICB0aHJvdyAnTWVtYmVySW52aXRlSW5wdXQgcmVxdWlyZXMgd29ya3NwYWNlIHRvIGF1dG9jb21wbGV0ZS4gSW5qZWN0IHdvcmtzcGFjZSB0byBjb21wb25lbnQgYXMgd29ya3NwYWNlPXdvcmtzcGFjZSdcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmF1dGgpIHtcclxuICAgICAgICAgICAgdGhyb3cgJ01lbWJlckludml0ZUlucHV0IHJlcXVpcmVzIGF1dGggc2VydmljZSB0byBhdXRvY29tcGxldGUuIEluamVjdCBhdXRoIHRvIGNvbXBvbmVudCBhcyBhdXRoPWF1dGgnXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZWwgPSBFbWJlci4kKHRoaXMuZ2V0KCdlbGVtZW50JykpO1xyXG5cclxuICAgICAgICB2YXIgYWpheFF1ZXJ5Q29udGV4dCA9IHt9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiB2YWxpZGF0ZUVtYWlsKGVtYWlsKSB7XHJcbiAgICAgICAgICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ2MTgxLzExMjM2XHJcbiAgICAgICAgICAgIHZhciByZSA9IC9eKChbXjw+KClbXFxdXFxcXC4sOzpcXHNAXFxcIl0rKFxcLltePD4oKVtcXF1cXFxcLiw7Olxcc0BcXFwiXSspKil8KFxcXCIuK1xcXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xyXG4gICAgICAgICAgICByZXR1cm4gcmUudGVzdChlbWFpbCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdmFyIGFqYXhRdWVyeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG1lbWJlcnMgPSB0aGlzLnN0b3JlLmZpbmQoJ01lbWJlcicsIHtcclxuICAgICAgICAgICAgICAgIHdvcmtzcGFjZTogVXRpbHMuRS5yZWNvcmRJZCh0aGlzLndvcmtzcGFjZSksXHJcbiAgICAgICAgICAgICAgICBzZWFyY2g6IHRoaXMucXVlcnkudGVybSxcclxuICAgICAgICAgICAgICAgIG9yZGVyaW5nOiAnLXN0YXR1cydcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChtZW1iZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBtZW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKG1lbWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW52aXRhdGlvbiA9IG1lbWJlci5nZXQoJ3N0YXR1cycpID09IG1lbWJlci5zdGF0dXNlc1snSU5WSVRFRCddLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90IGluY2x1ZGUgY3VycmVudCB1c2VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZW1iZXIuZ2V0KCd1c2VyJykgIT0gdGhpcy5hdXRoLmdldCgndXNlci5pZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludml0YXRpb246IGludml0YXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWVtYmVyLmdldCgnZW1haWwnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaW52aXRhdGlvbiA/IG1lbWJlci5nZXQoJ2VtYWlsJykgOiBtZW1iZXIuZ2V0KCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pY2tuYW1lOiBtZW1iZXIuZ2V0KCduaWNrbmFtZScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiBtZW1iZXIuZ2V0KCdlbWFpbCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeS5jYWxsYmFjayh7cmVzdWx0czogcmVzdWx0c30pO1xyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBlbC5zZWxlY3QyKHtcclxuICAgICAgICAgICAgdG9rZW5TZXBhcmF0b3JzOiBbXCIsXCIsIFwiIFwiLCBcIjtcIl0sXHJcbiAgICAgICAgICAgIGNyZWF0ZVNlYXJjaENob2ljZTogZnVuY3Rpb24gKHRlcm0sIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhZGQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChtZW1iZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGVybSA9PSBtZW1iZXIuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXZhbGlkYXRlRW1haWwodGVybSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYWRkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW52aXRhdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGVybSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmlja25hbWU6IHRlcm0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0ZXJtLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0ZXJtLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG11bHRpcGxlOiB0cnVlLFxyXG4gICAgICAgICAgICBxdWVyeTogZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgICBhamF4UXVlcnlDb250ZXh0LnN0b3JlID0gdGhpcy5nZXQoJ2NvbnRyb2xsZXIuc3RvcmUnKVxyXG4gICAgICAgICAgICAgICAgYWpheFF1ZXJ5Q29udGV4dC5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgICAgICAgICAgYWpheFF1ZXJ5Q29udGV4dC5hdXRoID0gdGhpcy5nZXQoJ2F1dGgnKVxyXG4gICAgICAgICAgICAgICAgYWpheFF1ZXJ5Q29udGV4dC53b3Jrc3BhY2UgPSB0aGlzLmdldCgnd29ya3NwYWNlJylcclxuICAgICAgICAgICAgICAgIEVtYmVyLnJ1bi5kZWJvdW5jZShhamF4UXVlcnlDb250ZXh0LCBhamF4UXVlcnksIDUwMCk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksXHJcblxyXG4gICAgICAgICAgICBmb3JtYXRSZXN1bHQ6IGZ1bmN0aW9uIChtZW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBVdGlscy5IYW5kbGViYXJzSGVscGVycy5jdXJyZW50KCkucHJpbnRVc2VyKG1lbWJlciwge2hhc2g6IHtkaXNhYmxlVG9vbHRpcDogdHJ1ZX19KVxyXG4gICAgICAgICAgICAgICAgaWYgKG1lbWJlci5pbnZpdGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gJ0ludml0ZSA8Yj4nICsgc3RyICsgJzwvYj4nXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9ICdncmFudCB0byA8Yj4nICsgc3RyICsgJzwvYj4nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBmb3JtYXRTZWxlY3Rpb246IGZ1bmN0aW9uIChtZW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBVdGlscy5IYW5kbGViYXJzSGVscGVycy5jdXJyZW50KCkucHJpbnRVc2VyKG1lbWJlciwge2hhc2g6IHtkaXNhYmxlVG9vbHRpcDogdHJ1ZX19KVxyXG4gICAgICAgICAgICAgICAgaWYgKG1lbWJlci5pbnZpdGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gJ0ludml0ZSA8Yj4nICsgc3RyICsgJzwvYj4nXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9ICdncmFudCB0byA8Yj4nICsgc3RyICsgJzwvYj4nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGVsLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldCgndmFsdWUnLCBlLnZhbClcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH1cclxuXHJcbn0pO1xyXG5cclxuVmF1bHRpZXIuTWVtYmVyU2VsZWN0Um9sZVZpZXcgPSBFbWJlci5TZWxlY3QuZXh0ZW5kKHtcclxuXHJcbiAgICB3aWxsRGVzdHJveUVsZW1lbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZWwgPSAkKHRoaXMuZ2V0KCdlbGVtZW50JykpO1xyXG4gICAgICAgIHZhciBzZWxlY3RpemUgPSBlbFswXS5zZWxlY3RpemU7XHJcbiAgICAgICAgc2VsZWN0aXplLmRlc3Ryb3koKTtcclxuICAgIH0sXHJcblxyXG4gICAgZGlkSW5zZXJ0RWxlbWVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbCA9ICQodGhpcy5nZXQoJ2VsZW1lbnQnKSk7XHJcbiAgICAgICAgZWwuc2VsZWN0aXplKHtcclxuICAgICAgICAgICAgY3JlYXRlOiBmYWxzZSxcclxuICAgICAgICAgICAgaGlnaGxpZ2h0OiBmYWxzZSxcclxuICAgICAgICAgICAgcmVuZGVyOiB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb246IGZ1bmN0aW9uIChpdGVtLCBlc2NhcGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IFZhdWx0aWVyLlJvbGUucHJvdG8oKS5yb2xlcy5nZXRCeVZhbHVlKGl0ZW0udmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2PicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2PicgKyBpdGVtLnRleHQgKyAnPC9kaXY+JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJoZWxwLWJsb2NrXCI+JyArIGl0ZW0uZGVzYyArICc8L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbignJylcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdmFyIHNlbGVjdGl6ZSA9IGVsWzBdLnNlbGVjdGl6ZTtcclxuICAgICAgICBzZWxlY3RpemUuc2V0VmFsdWUodGhpcy5nZXQoJ3JvbGUubGV2ZWwnKSk7XHJcblxyXG4gICAgICAgIHNlbGVjdGl6ZS5vbignZHJvcGRvd25fY2xvc2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VsZWN0aXplLmdldFZhbHVlKCkpIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGl6ZS5zZXRWYWx1ZSh0aGlzLmdldCgncm9sZS5sZXZlbCcpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgc2VsZWN0aXplLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldCgncm9sZS5sZXZlbCcsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZCgnY2hhbmdlZCcsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG5cclxuICAgIH1cclxufSk7XHJcbiIsIlZhdWx0aWVyLk1lbWJlckluZGV4Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoXHJcbiAgICB7XHJcblxyXG4gICAgICAgIGludml0ZU9iamVjdDogbnVsbCxcclxuXHJcbiAgICAgICAgbW9kZWw6IGZ1bmN0aW9uIChwYXJhbXMsIHRyYW5zaXRpb24pIHtcclxuICAgICAgICAgICAgLy8gc2V0dXAgaW52aXRlIGRhdGFcclxuICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHRoaXMuc2V0dXBJbnZpdGVEYXRhKHBhcmFtcykpXHJcblxyXG4gICAgICAgICAgICAvLyBjaGVjayBwZXJtaXNzaW9uc1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0KCdhdXRoJykuY2hlY2tQZXJtaXNzaW9ucyh0cmFuc2l0aW9uLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2ludml0ZU9iamVjdC5wZXJtcy5pbnZpdGUnKVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHRydWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGRvIGxvb2t1cFxyXG4gICAgICAgICAgICB2YXIgYmxvY2tzID0gdGhpcy5zZXR1cEJsb2NrcygpO1xyXG4gICAgICAgICAgICB2YXIgd29ya3NwYWNlID0gdGhpcy5tb2RlbEZvcignV29ya3NwYWNlJyk7XHJcbiAgICAgICAgICAgIHZhciB2YXVsdCA9IHRoaXMubW9kZWxGb3IoJ1ZhdWx0Jyk7XHJcbiAgICAgICAgICAgIHZhciBjYXJkID0gdGhpcy5tb2RlbEZvcignQ2FyZCcpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHN0b3JlID0gdGhpcy5nZXQoJ3N0b3JlJylcclxuXHJcbiAgICAgICAgICAgIHZhciBxdWVyaWVzID0ge1xyXG4gICAgICAgICAgICAgICAgd29ya3NwYWNlOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgd29ya3NwYWNlUm9sZXM6IG51bGwsXHJcbiAgICAgICAgICAgICAgICB2YXVsdDogbnVsbCxcclxuICAgICAgICAgICAgICAgIHZhdWx0Um9sZXM6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBjYXJkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgY2FyZFJvbGVzOiBudWxsXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAoYmxvY2tzLndvcmtzcGFjZSkge1xyXG4gICAgICAgICAgICAgICAgcXVlcmllcy53b3Jrc3BhY2UgPSB3b3Jrc3BhY2VcclxuICAgICAgICAgICAgICAgIHF1ZXJpZXMud29ya3NwYWNlUm9sZXMgPSBzdG9yZS5maW5kKCdSb2xlJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvX3dvcmtzcGFjZTogd29ya3NwYWNlLmdldCgnaWQnKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGJsb2Nrcy52YXVsdCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcmllcy52YXVsdCA9IHZhdWx0XHJcbiAgICAgICAgICAgICAgICBxdWVyaWVzLnZhdWx0Um9sZXMgPSBzdG9yZS5maW5kKCdSb2xlJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvX3ZhdWx0OiB2YXVsdC5nZXQoJ2lkJylcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChibG9ja3MuY2FyZCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcmllcy5jYXJkID0gY2FyZFxyXG4gICAgICAgICAgICAgICAgcXVlcmllcy5jYXJkUm9sZXMgPSBzdG9yZS5maW5kKCdSb2xlJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvX2NhcmQ6IGNhcmQuZ2V0KCdpZCcpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgbW9kZWxzID0gRW1iZXIuUlNWUC5oYXNoKHF1ZXJpZXMpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1vZGVscztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvdmVycmlkZSB0aGlzIHRvIHNldHVwIGludml0ZSBicmVhZGNydW1ic1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwQmxvY2tzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRocm93ICdQbGVhc2Ugb3ZlcnJpZGUgdGhpcyBpbiB5b3VyIHJvdXRlJ1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIG92ZXJyaWRlIHRoaXMgdG8gc2V0dXAgaW52aXRlIGJyZWFkY3J1bWJzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0dXBJbnZpdGVSb3V0ZTogZnVuY3Rpb24gKG1vZGVscykge1xyXG4gICAgICAgICAgICB0aHJvdyAnUGxlYXNlIG92ZXJyaWRlIHRoaXMgaW4geW91ciByb3V0ZSdcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvdmVycmlkZSB0aGlzIHRvIHNldHVwIGludml0ZSBicmVhZGNydW1ic1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwSW52aXRlRGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgICAgICB0aHJvdyAnUGxlYXNlIG92ZXJyaWRlIHRoaXMgaW4geW91ciByb3V0ZSdcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvdmVycmlkZSB0aGlzIHRvIHNldHVwIGludml0ZSBicmVhZGNydW1ic1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwUm9sZUxldmVsczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVmF1bHRpZXIuUm9sZS5wcm90bygpLnJvbGVzLnRvQXJyYXkoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvdmVycmlkZSB0aGlzIHRvIHNldHVwIGludml0ZSBicmVhZGNydW1ic1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwQnJlYWRjcnVtYnM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhyb3cgJ1BsZWFzZSBvdmVycmlkZSB0aGlzIGluIHlvdXIgcm91dGUnXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbiAoY3RybCwgbW9kZWxzKSB7XHJcbiAgICAgICAgICAgIHZhciBibG9ja3MgPSBbXTtcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAobW9kZWxzLmNhcmQpIHtcclxuICAgICAgICAgICAgICAgIGJsb2Nrcy5wdXNoKEVtYmVyLk9iamVjdC5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2FyZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0OiBtb2RlbHMuY2FyZCxcclxuICAgICAgICAgICAgICAgICAgICByb2xlczogbW9kZWxzLmNhcmRSb2xlc1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobW9kZWxzLnZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBibG9ja3MucHVzaChFbWJlci5PYmplY3QuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndmF1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy5nZXQoJ3JvdXRlcicpLmdlbmVyYXRlKCdWYXVsdC5tZW1iZXJJbmRleCcsIG1vZGVscy52YXVsdCksXHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0OiBtb2RlbHMudmF1bHQsXHJcbiAgICAgICAgICAgICAgICAgICAgcm9sZXM6IG1vZGVscy52YXVsdFJvbGVzXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtb2RlbHMud29ya3NwYWNlKSB7XHJcbiAgICAgICAgICAgICAgICBibG9ja3MucHVzaChFbWJlci5PYmplY3QuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnd29ya3NwYWNlJyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRoaXMuZ2V0KCdyb3V0ZXInKS5nZW5lcmF0ZSgnV29ya3NwYWNlLm1lbWJlckluZGV4JywgbW9kZWxzLndvcmtzcGFjZSksXHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0OiBtb2RlbHMud29ya3NwYWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJvbGVzOiBtb2RlbHMud29ya3NwYWNlUm9sZXNcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdjb250ZW50JywgYmxvY2tzKVxyXG5cclxuICAgICAgICAgICAgLy8gc2V0dXAgcm9sZXNcclxuICAgICAgICAgICAgY3RybC5zZXQoJ3JvbGVMZXZlbHMnLCB0aGlzLnNldHVwUm9sZUxldmVscygpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNldCBpbnZpdGUgcm91dGVcclxuICAgICAgICAgICAgY3RybC5zZXRQcm9wZXJ0aWVzKHRoaXMuc2V0dXBJbnZpdGVSb3V0ZShtb2RlbHMpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNldCBicmVhZGNydW1ic1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnYnJlYWRjcnVtYnMnLCB0aGlzLnNldHVwQnJlYWRjcnVtYnMobW9kZWxzKSlcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGltcG9ydGFudCBpZiB5b3Ugd2FudCB0byBpbmhlcml0ZSB0aGlzIHJvdXRlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbWJlcmpzL2VtYmVyLmpzL2lzc3Vlcy8xODcyIHRvIHVzZSBwcm9wZXIgY29udHJvbGxlclxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcignTWVtYmVySW5kZXgnLCB7Y29udHJvbGxlcjogdGhpcy5nZXQoJ2NvbnRyb2xsZXInKX0pXHJcbiAgICAgICAgfSxcclxuXHJcblxyXG4gICAgICAgIGFjdGlvbnM6IHtcclxuICAgICAgICAgICAgZGVsZXRlUm9sZTogZnVuY3Rpb24gKHJvbGUsIGJsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICBWYXVsdGllci5jb25maXJtTW9kYWwodGhpcywgJ0FyZSB5b3Ugc3VyZT8nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSByb2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZWxldGVSZWNvcmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jay5yb2xlcy5yZW1vdmVPYmplY3Qocm9sZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnVXNlciBcXCdzIHBlcm1pc3Npb24gaGFzIGJlZW4gcmVtb3ZlZC4nLCAnc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0KCdlcnJvcnMnKS5sb2dFcnJvcihlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgY2hhbmdlUm9sZTogZnVuY3Rpb24gKHJvbGUsIGJsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHJvbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2F2ZVJlY29yZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnVXNlciBcXCdzIHBlcm1pc3Npb24gaGFzIGJlZW4gdXBkYXRlZC4nLCAnc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXQoJ2Vycm9ycycpLmxvZ0Vycm9yKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSlcclxuXHJcbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICB9KTtcclxuXHJcblZhdWx0aWVyLk1lbWJlckluZGV4Q29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHtcclxuICAgIGJsb2NrczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWNvbmRNYXJrZWQgPSBmYWxzZTtcclxuICAgICAgICB2YXIgc2hvd25JbmRleCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdjb250ZW50JykubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgaXNIaWRkZW4gPSBpdGVtLnJvbGVzLmdldCgnbGVuZ3RoJykgPT09IDAgJiYgaW5kZXggPiAwO1xyXG4gICAgICAgICAgICBpZiAoIWlzSGlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICBzaG93bkluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGlzU2Vjb25kID0gIWlzSGlkZGVuICYmIHNob3duSW5kZXggPT09IDI7XHJcblxyXG4gICAgICAgICAgICBpdGVtLnNldFByb3BlcnRpZXMoe1xyXG4gICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgICAgICAgaXNTZWNvbmQ6IGlzU2Vjb25kLFxyXG4gICAgICAgICAgICAgICAgaXNIaWRkZW46IGlzSGlkZGVuLFxyXG4gICAgICAgICAgICAgICAgcmVhZE9ubHk6IGluZGV4ID4gMFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfS5wcm9wZXJ0eSgnY29udGVudC5AZWFjaCcpXHJcbn0pO1xyXG5cclxuXHJcblZhdWx0aWVyLk1lbWJlckluZGV4VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcclxuICAgIHRlbXBsYXRlTmFtZTogJ01lbWJlci9NZW1iZXJJbmRleCcsXHJcbiAgICBsYXlvdXROYW1lOiAnTGF5b3V0L0xheW91dFN0YW5kYXJkJyxcclxuXHJcblxyXG4gICAgSXRlbTogRW1iZXIuVmlldy5leHRlbmQoe1xyXG4gICAgICAgIHRhZ05hbWU6ICdkaXYnLFxyXG4gICAgICAgIFNlbGVjdDogVmF1bHRpZXIuTWVtYmVyU2VsZWN0Um9sZVZpZXcuZXh0ZW5kKHtcclxuICAgICAgICAgICAgYWN0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0KCdjb250cm9sbGVyJykuc2VuZCgnY2hhbmdlUm9sZScsIHRoaXMuZ2V0KCdyb2xlJyksIHRoaXMuZ2V0KCdibG9jaycpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgIH0pXHJcblxyXG59KTtcclxuXHJcbiIsIlZhdWx0aWVyLk1lbWJlckludml0ZVJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKFxyXG4gICAge1xyXG5cclxuICAgICAgICBpbnZpdGVPYmplY3Q6IG51bGwsXHJcblxyXG4gICAgICAgIG1vZGVsOiBmdW5jdGlvbiAocGFyYW1zLCB0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh0aGlzLnNldHVwSW52aXRlRGF0YShwYXJhbXMpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIHBlcm1pc3Npb25zXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXQoJ2F1dGgnKS5jaGVja1Blcm1pc3Npb25zKHRyYW5zaXRpb24sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldCgnaW52aXRlT2JqZWN0LnBlcm1zLmludml0ZScpXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdHJ1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIG92ZXJyaWRlIHRoaXMgdG8gc2V0dXAgaW52aXRlIHdvcmtzcGFjZSBhbmQgaW52aXRlIHRvIG9iamVjdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwSW52aXRlRGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgICAgICB0aHJvdyAnUGxlYXNlIG92ZXJyaWRlIHRoaXMgaW4geW91ciByb3V0ZSdcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvdmVycmlkZSB0aGlzIHRvIHNldHVwIGludml0ZSBicmVhZGNydW1ic1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldHVwQnJlYWRjcnVtYnM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhyb3cgJ1BsZWFzZSBvdmVycmlkZSB0aGlzIGluIHlvdXIgcm91dGUnXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogb3ZlcnJpZGUgdGhpcyB0byBzZXR1cCBpbnZpdGUgYnJlYWRjcnVtYnNcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXR1cFJvbGVMZXZlbHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFZhdWx0aWVyLlJvbGUucHJvdG8oKS5yb2xlcy50b0FycmF5KCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0RGVmYXVsdFJvbGVMZXZlbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBWYXVsdGllci5Sb2xlLnByb3RvKCkucm9sZXNbJ1JFQUQnXS52YWx1ZVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFjdGlvbnM6IHtcclxuICAgICAgICAgICAgc2F2ZTogZnVuY3Rpb24gKGludml0ZWQsIHJvbGUsIHJlc2VuZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGludml0YXRpb25zID0gdGhpcy5nZXQoJ2ludml0YXRpb25zJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW52aXRlV29ya3NwYWNlID0gdGhpcy5nZXQoJ2ludml0ZVdvcmtzcGFjZScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGludml0ZVBhcmFtcyA9IHRoaXMuZ2V0KCdpbnZpdGVQYXJhbXMnKTtcclxuICAgICAgICAgICAgICAgIHZhciBpbnZpdGVkUHJvbWlzZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpbnZpdGVkLmZvckVhY2goZnVuY3Rpb24gKGVtYWlsT3JJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGludml0ZWRQcm9taXNlcy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZpdGF0aW9ucy5pbnZpdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZpdGVXb3Jrc3BhY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbE9ySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlLmxldmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52aXRlUGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2VuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBidWxrID0gRW1iZXIuUlNWUC5hbGwoaW52aXRlZFByb21pc2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5ub3RpZnkoJ1lvdXIgaW52aXRhdGlvbnMgaGFzIGJlZW4gc2F2ZWQnLCAnc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uTG9hZGVyLnByb21pc2UoYnVsayk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1bGs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0aW9uIChjdHJsLCBtb2RlbCkge1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnd29ya3NwYWNlJywgdGhpcy5tb2RlbEZvcignV29ya3NwYWNlJykpXHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdicmVhZGNydW1icycsIHRoaXMuc2V0dXBCcmVhZGNydW1icygpKTtcclxuICAgICAgICAgICAgY3RybC5zZXQoJ2ludml0ZWQnLCBbXSk7XHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdyb2xlJywge2xldmVsOiB0aGlzLmdldERlZmF1bHRSb2xlTGV2ZWwoKX0pO1xyXG4gICAgICAgICAgICBjdHJsLnNldCgncm9sZUxldmVscycsIHRoaXMuc2V0dXBSb2xlTGV2ZWxzKCkpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgaW1wb3J0YW50IGlmIHlvdSB3YW50IHRvIGluaGVyaXRlIHRoaXMgcm91dGUgaHR0cHM6Ly9naXRodWIuY29tL2VtYmVyanMvZW1iZXIuanMvaXNzdWVzLzE4NzIgdG8gdXNlIHByb3BlciBjb250cm9sbGVyXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCdNZW1iZXJJbnZpdGUnLCB7Y29udHJvbGxlcjogdGhpcy5nZXQoJ2NvbnRyb2xsZXInKX0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuVmF1bHRpZXIuTWVtYmVySW52aXRlQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHtcclxuICAgIHdvcmtzcGFjZTogbnVsbCxcclxuICAgIHJvbGU6IG51bGwsXHJcbiAgICBpbnZpdGVkOiBbXSxcclxuICAgIHJlc2VuZDogdHJ1ZSxcclxuXHJcbiAgICBpc1N1Ym1pdERpc2FibGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmdldCgnaW52aXRlZC5sZW5ndGgnKSB8fCAhdGhpcy5nZXQoJ3JvbGUubGV2ZWwnKVxyXG4gICAgfS5wcm9wZXJ0eSgnaW52aXRlZC5sZW5ndGgnLCAncm9sZS5sZXZlbCcpLFxyXG5cclxuICAgIGJyZWFkY3J1bWJzOiBudWxsXHJcbn0pO1xyXG5cclxuVmF1bHRpZXIuTWVtYmVySW52aXRlVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcclxuICAgIHRlbXBsYXRlTmFtZTogJ01lbWJlci9NZW1iZXJJbnZpdGUnLFxyXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCcsXHJcblxyXG4gICAgU2VsZWN0OiBWYXVsdGllci5NZW1iZXJTZWxlY3RSb2xlVmlld1xyXG59KTsiLCJWYXVsdGllci5NZW1iZXJCb3hDb21wb25lbnQgPSBFbWJlci5Db21wb25lbnQuZXh0ZW5kKHtcbiAgICBsYXlvdXROYW1lOiAnTWVtYmVyL01lbWJlckJveCcsXG5cbiAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuY2hlY2tQYXJhbWV0ZXJzKCk7XG4gICAgfSxcblxuICAgIGNoZWNrUGFyYW1ldGVyczogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcm9sZXMgPSB0aGlzLmdldCgncm9sZXMnKTtcbiAgICAgICAgdmFyIHVzZXIgPSB0aGlzLmdldCgndXNlcicpO1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHJvbGVzKSAhPSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JvbGVzIGFycmF5IGhhcyB0byBiZSBwYXNzZWQgYXMgcm9sZXM9W1ZhdWx0aWVyLlJvbGVdIHBhcmFtZXRlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF1c2VyIHx8IHVzZXIuY29uc3RydWN0b3IgIT0gVmF1bHRpZXIuVXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDdXJyZW50IHVzZXIgaGFzIHRvIGJlIHBhc3NlZCBhcyB1c2VyPVZhdWx0aWVyLlVzZXInKVxuICAgICAgICB9XG5cbiAgICB9LFxuXG5cbiAgICBwcm9jZXNzZWRSb2xlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyByZW1vdmUgbWUgZnJvbSByb2xlc1xuICAgICAgICB2YXIgcm9sZXMgPSB0aGlzLmdldCgncm9sZXMnKS5maWx0ZXIoZnVuY3Rpb24gKHJvbGUpIHtcbiAgICAgICAgICAgIGlmIChyb2xlLmdldCgnbWVtYmVyLnVzZXInKSAhPSB0aGlzLmdldCgndXNlci5pZCcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0uYmluZCh0aGlzKSlcblxuICAgICAgICAvLyBzb3J0IGJ5IHBlcm1pc3Npb24gbGV2ZWxcbiAgICAgICAgcm9sZXMgPSByb2xlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYi5nZXQoJ2xldmVsJykgLSBhLmdldCgnbGV2ZWwnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gdW5pcXVlIGFycmF5XG4gICAgICAgIHZhciBmb3VuZFJvbGVzID0gW11cbiAgICAgICAgcm9sZXMgPSByb2xlcy5maWx0ZXIoZnVuY3Rpb24gKHJvbGUpIHtcbiAgICAgICAgICAgIHZhciBpZCA9IHJvbGUuZ2V0KCdtZW1iZXIuaWQnKTtcbiAgICAgICAgICAgIGlmIChmb3VuZFJvbGVzLmluZGV4T2YoaWQpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgZm91bmRSb2xlcy5wdXNoKGlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9sZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gcm9sZXM7XG4gICAgfS5wcm9wZXJ0eSgncm9sZXMnKSxcblxuICAgIGhhc0FueTogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5nZXQoJ3Byb2Nlc3NlZFJvbGVzJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0ucHJvcGVydHkoJ3Byb2Nlc3NlZFJvbGVzJyksXG5cbiAgICBoYXNSZWFkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldCgncm9sZXNSZWFkJykubGVuZ3RoICE9IDBcbiAgICB9LnByb3BlcnR5KCdyb2xlc1JlYWQnKSxcblxuICAgIHJvbGVzUmVhZDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ3Byb2Nlc3NlZFJvbGVzJykuZmlsdGVyKGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgICAgICBpZiAocm9sZS5nZXQoJ2xldmVsJykgPT0gVmF1bHRpZXIuUm9sZS5wcm90bygpLnJvbGVzWydSRUFEJ10udmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9sZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfS5wcm9wZXJ0eSgncHJvY2Vzc2VkUm9sZXMnKSxcblxuICAgIGhhc0NyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ3JvbGVzQ3JlYXRlJykubGVuZ3RoICE9IDBcbiAgICB9LnByb3BlcnR5KCdyb2xlc0NyZWF0ZScpLFxuXG4gICAgcm9sZXNDcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdwcm9jZXNzZWRSb2xlcycpLmZpbHRlcihmdW5jdGlvbiAocm9sZSkge1xuICAgICAgICAgICAgaWYgKHJvbGUuZ2V0KCdsZXZlbCcpID09IFZhdWx0aWVyLlJvbGUucHJvdG8oKS5yb2xlc1snQ1JFQVRFJ10udmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9sZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfS5wcm9wZXJ0eSgncHJvY2Vzc2VkUm9sZXMnKSxcblxuXG4gICAgaGFzV3JpdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdyb2xlc1dyaXRlJykubGVuZ3RoICE9IDBcbiAgICB9LnByb3BlcnR5KCdyb2xlc1dyaXRlJyksXG5cbiAgICByb2xlc1dyaXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldCgncHJvY2Vzc2VkUm9sZXMnKS5maWx0ZXIoZnVuY3Rpb24gKHJvbGUpIHtcbiAgICAgICAgICAgIGlmIChyb2xlLmdldCgnbGV2ZWwnKSA9PSBWYXVsdGllci5Sb2xlLnByb3RvKCkucm9sZXNbJ1dSSVRFJ10udmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9sZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfS5wcm9wZXJ0eSgncHJvY2Vzc2VkUm9sZXMnKVxuXG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxuVmF1bHRpZXIuTWVtYmVyTWFuYWdlbWVudFJvdXRlID0gVmF1bHRpZXIuTWVtYmVySW5kZXhSb3V0ZS5leHRlbmQoe1xuICAgIG1vZGVsOiBmdW5jdGlvbiAocGFyYW1zLCB0cmFuc2l0aW9uKSB7XG5cbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHRoaXMuc2V0dXBJbnZpdGVEYXRhKHBhcmFtcykpO1xuXG4gICAgICAgIHZhciB3b3Jrc3BhY2UgPSB0aGlzLm1vZGVsRm9yKCdXb3Jrc3BhY2UnKTtcblxuICAgICAgICB2YXIgc3RvcmUgPSB0aGlzLmdldCgnc3RvcmUnKTtcbiAgICAgICAgdmFyIG1lbWJlcnMgPSBzdG9yZS5maW5kKCdNZW1iZXInLCB7IHdvcmtzcGFjZTogd29ya3NwYWNlLmdldCgnaWQnKX0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRW0uQXJyYXlQcm94eS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiByZXNwb25zZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHF1ZXJpZXMgPSB7XG4gICAgICAgICAgICB3b3Jrc3BhY2U6IHdvcmtzcGFjZSxcbiAgICAgICAgICAgIG1lbWJlcnM6IG1lbWJlcnNcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICBFbWJlci5SU1ZQLmhhc2gocXVlcmllcyk7XG4gICAgfSxcblxuICAgIHNldHVwQ29udHJvbGxlcjogZnVuY3Rpb24gKGN0cmwsIG1vZGVsKSB7XG5cbiAgICAgICAgY3RybC5zZXQoJ2NvbnRlbnQnLCBtb2RlbCk7XG5cbiAgICAgICAgLy8gc2V0IGJyZWFkY3J1bWJzXG4gICAgICAgIGN0cmwuc2V0KCdicmVhZGNydW1icycsIHRoaXMuc2V0dXBCcmVhZGNydW1icyhtb2RlbCkpXG4gICAgfSxcblxuICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyKCdNZW1iZXJNYW5hZ2VtZW50Jywge2NvbnRyb2xsZXI6IHRoaXMuZ2V0KCdjb250cm9sbGVyJyl9KTtcbiAgICB9LFxuICAgIGFjdGlvbnM6IHtcbiAgICAgICAgZGVsZXRlUm9sZTogZnVuY3Rpb24gKGNvbnRleHQsIHJvbGUpIHtcblxuICAgICAgICAgICAgVmF1bHRpZXIuY29uZmlybU1vZGFsKHRoaXMsICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcGVybWlzc2lvbj8nLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHJvbGVcbiAgICAgICAgICAgICAgICAgICAgLmRlbGV0ZVJlY29yZCgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb2xlcyA9IGNvbnRleHQuZ2V0KCdyb2xlcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXMucmVtb3ZlT2JqZWN0KHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5ub3RpZnkoJ1JvbGUgaGFzIGJlZW4gcmVtb3ZlJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0KCdlcnJvcnMnKS5sb2dFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGxvYWRSb2xlczogZnVuY3Rpb24gKGNvbnRleHQsIG1lbWJlcikge1xuICAgICAgICAgICAgdmFyIHJvbGVzID0gY29udGV4dC5nZXQoJ3JvbGVzJyk7XG5cbiAgICAgICAgICAgIHZhciBzdG9yZSA9IHRoaXMuZ2V0KCdzdG9yZScpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBzdG9yZS5maW5kKFxuICAgICAgICAgICAgICAgICdSb2xlJyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRvX3dvcmtzcGFjZTogbWVtYmVyLmdldCgnd29ya3NwYWNlJyksXG4gICAgICAgICAgICAgICAgICAgIHRvX21lbWJlcjogbWVtYmVyLmdldCgnaWQnKVxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZW1iZXJSb2xlcyA9IEVtLkFycmF5UHJveHkuY3JlYXRlKHtjb250ZW50OiByZXNwb25zZX0pLnRvQXJyYXkoKTtcblxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNldCgncm9sZXMnLCBtZW1iZXJSb2xlcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXJSb2xlcztcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgQXBwbGljYXRpb25Mb2FkZXIucHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlTWVtYmVyOiBmdW5jdGlvbiAoY29udGV4dCwgbWVtYmVyKSB7XG5cbiAgICAgICAgICAgIFZhdWx0aWVyLmNvbmZpcm1Nb2RhbCh0aGlzLCAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIG1lbWJlcj8nLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG1lbWJlclxuICAgICAgICAgICAgICAgICAgICAuZGVsZXRlUmVjb3JkKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlcnMgPSBjb250ZXh0LmdldCgnbWVtYmVycycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVycy5yZW1vdmVPYmplY3QobWVtYmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQubm90aWZ5KCdNZW1iZXIgaGFzIGJlZW4gcmVtb3ZlJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0KCdlcnJvcnMnKS5sb2dFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuVmF1bHRpZXIuTWVtYmVyTWFuYWdlbWVudENvbnRyb2xsZXIgPSBWYXVsdGllci5NZW1iZXJJbmRleENvbnRyb2xsZXIuZXh0ZW5kKHtcbiAgICBtZW1iZXJzOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHVzZXIgPSB0aGlzLmdldCgnYXV0aC51c2VyJyk7XG4gICAgICAgIHJldHVybiB0aGlzLmdldCgnY29udGVudC5tZW1iZXJzJykuZmlsdGVyKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmdldCgnZW1haWwnKSAhPT0gdXNlci5nZXQoJ2VtYWlsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICkudG9BcnJheSgpO1xuICAgIH0ucHJvcGVydHkoJ2NvbnRlbnQuQGVhY2gnKVxufSk7XG5cblxuVmF1bHRpZXIuTWVtYmVyTWFuYWdlbWVudFZpZXcgPSBWYXVsdGllci5NZW1iZXJJbmRleFZpZXcuZXh0ZW5kKHtcbiAgICB0ZW1wbGF0ZU5hbWU6ICdNZW1iZXIvTWVtYmVyTWFuYWdlbWVudCdcbn0pO1xuXG5cblZhdWx0aWVyLk1lbWJlck1hbmFnZXJBY2NvcmRpb25Db21wb25lbnQgPSBFbS5Db21wb25lbnQuZXh0ZW5kKHtcbiAgICBzdG9yZTogbnVsbCxcbiAgICBsYXlvdXROYW1lOiAnTWVtYmVyL01lbWJlck1hbmFnZXJBY2NvcmRpb24nLFxuICAgIGJ1aWxkSWQ6IGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL1tAXFwuXS9nLCAnICcpO1xuICAgICAgICByZXR1cm4gRW0uU3RyaW5nLmRhc2hlcml6ZShzdHIpICsgJy1yb2xlcyc7XG4gICAgfSxcbiAgICB0YXJnZXRFbGVtZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzLmJ1aWxkSWQodGhpcy5nZXQoJ21lbWJlci5uaWNrbmFtZScpKTtcbiAgICAgICAgcmV0dXJuICcjJyArIHN0cjtcbiAgICB9LnByb3BlcnR5KCksXG4gICAgaWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRJZCh0aGlzLmdldCgnbWVtYmVyLm5pY2tuYW1lJykpO1xuICAgIH0ucHJvcGVydHkoKSxcbiAgICByb2xlczogbnVsbCxcbiAgICBjb250cm9sOiBudWxsLFxuICAgIG1lbWJlcjogbnVsbCxcbiAgICByb2xlTGV2ZWxzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBWYXVsdGllci5Sb2xlLnByb3RvKCkucm9sZXMudG9BcnJheSgpO1xuICAgIH0ucHJvcGVydHkoJ2NvbnRlbnQuQGVhY2gnKSxcbiAgICBhY3Rpb25zOiB7XG5cbiAgICAgICAgbG9hZFJvbGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRBY3Rpb24oJ2xvYWRSb2xlcycsIHRoaXMuZ2V0KCdjb250ZXh0JyksIHRoaXMuZ2V0KCdtZW1iZXInKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZVJvbGU6IGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRBY3Rpb24oJ2RlbGV0ZVJvbGUnLCB0aGlzLmdldCgnY29udGV4dCcpLCByb2xlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlTWVtYmVyOiBmdW5jdGlvbiAobWVtYmVyKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRBY3Rpb24oJ2RlbGV0ZU1lbWJlcicsIHRoaXMuZ2V0KCdjb250ZXh0JyksIG1lbWJlcik7XG4gICAgICAgIH1cbiAgICB9XG59KVxuOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==