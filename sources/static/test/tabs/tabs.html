<!DOCTYPE html>
<html>
<!--
  Created using jsbin.com
  Source can be edited via http://jsbin.com/OmuWeJo/1/edit
-->
<head>
    <script src="./../../lib/jquery/jquery.js"></script>
    <script src="./../../lib/handlebars/handlebars.js"></script>
    <script src="./../../lib/ember/ember.js"></script>
    <script src="./../../lib/ember/ember-data.js"></script>
    <link href="http://twitter.github.io/bootstrap/assets/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="http://twitter.github.io/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet"
          type="text/css"/>
    <meta charset=utf-8/>
    <title>Ember + Bootstrap Tabs</title>

    <script type="text/x-handlebars">
        <h3>Ember + Twitter Bootstrap Tabs</h3>

        <p>Made by <a href="http://hawkins.io">Adam Hawkins</a></p>

        {{ outlet }}
    </script>

    <script type="text/x-handlebars" data-template-name="dashboard">
        <p>Dashboard</p>

        <ul class="nav nav-tabs">
            <li><a href="#" data-tab="home" {{ action selectTab "home"}}>Home</a></li>
            <li><a href="#" data-tab="profile" {{ action selectTab "profile"}}>Profile</a></li>
            <li><a href="#" data-tab="messages" {{ action selectTab "messages"}}>Messages</a></li>
            <li><a href="#" data-tab="settings" {{ action selectTab "settings"}}>Settings</a></li>
        </ul>

        {{ outlet tab}}
    </script>

    <script type="text/x-handlebars" data-template-name="home">
        <p>Home Tab</p>
    </script>

    <script type="text/x-handlebars" data-template-name="profile">
        <p>Profile Tab</p>
    </script>

    <script type="text/x-handlebars" data-template-name="messages">
        <p>Messsages Tab</p>
    </script>

    <script type="text/x-handlebars" data-template-name="settings">
        <p>Settings Tab</p>
    </script>

    <style id="jsbin-css">

    </style>
</head>
<body>

<script>
    App = Ember.Application.create();

    App.IndexRoute = Ember.Route.extend({
        redirect: function () {
            this.transitionTo('test.dashboard');
        }
    });

    App.Router.map(function () {
        this.resource('test', function() {
            this.route('dashboard');
        })
    });


    App.TestDashboardRoute = Ember.Route.extend({
        actions: {
            selectTab: function (name) {
                this.controllerFor('dashboard').set('activeTab', name);
                this.render(name, { into: 'dashboard', outlet: 'tab' });
            }
        },

        setupController: function (controller) {
            controller.set('activeTab', 'home');
        },

        renderTemplate: function () {
            this.render();
            this.render('home', { outlet: 'tab', into: 'dashboard' });
        }
    });

    App.DashboardView = Ember.View.extend({
        activeTab: Ember.computed.alias('controller.activeTab'),

        activeTabDidChange: (function () {
            if (this.state == 'inDOM') this.setActiveTab();
        }).observes('activeTab'),

        didInsertElement: function () {
            this.setActiveTab();
        },

        setActiveTab: function () {
            $('.active').removeClass('active');
            var activeTab = this.get('activeTab');
            this.$("a[data-tab='%@']".fmt(activeTab)).parent().addClass('active');
        }

    });
</script>
</body>
</html>