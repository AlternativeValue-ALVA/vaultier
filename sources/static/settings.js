Vaultier.ChangeKeyComponent=Ember.Component.extend({layoutName:"Settings/ChangeKey",keys:null,privateKeySaved:!1,publicKeySaved:!1,publicButtonDisabled:function(){return this.get("publicKeySaved")||!this.get("privateKeySaved")}.property("privateKeySaved","publicKeySaved"),didInsertElement:function(){if(!this.get("changekey"))throw Error("service:changekey has to be injected into changekey component");this.get("keys")||this.generate()},generate:function(){var e=this.get("changekey");e.generateKeys(function(e){this.set("keys",e)}.bind(this))},actions:{savePrivateKey:function(){var e=this.get("keys.privateKey"),t=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(t,"vaultier.key"),this.set("privateKeySaved",!0)},savePublicKey:function(){this.set("publicKeySaved",!0);var e={};this.sendAction("action",this.get("keys"),e),e.promise&&e.promise.catch(function(e){throw this.set("publicKeySaved",!1),e}.bind(this))}}});
Vaultier.SettingsRoute=Ember.Route.extend({beforeModel:function(t){return this.get("auth").checkAuthenticatedOrLogin(t)?void 0:!1},deactivate:function(){this.get("auth.user").rollback()}}),Vaultier.SettingsView=Ember.View.extend({TabView:Ember.View.extend({classNameBindings:"isActive:active".w(),tagName:"li",isActive:function(){var t=this.get("tab"),e=this.get("parentView.controller.controllers.application.currentPath"),i=e.split(".")[e.split(".").length-1];return t==i}.property("parentView.controller.controllers.application.currentPath")}),templateName:"Settings/SettingsIndex",layoutName:"Layout/LayoutStandard"}),Vaultier.SettingsController=Ember.Controller.extend({needs:["application"]}),Vaultier.SettingsIndexRoute=Ember.Route.extend({beforeModel:function(t){t.abort(),this.transitionTo("Settings.personal")}});
Vaultier.SettingsPersonalRoute=Ember.Route.extend({renderTemplate:function(){this.render("SettingsPersonal",{outlet:"Settings"})},setupController:function(e){e.set("content",this.get("auth.user")),e.get("controllers.Settings").set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addSettings().addText("Personal settings"))},actions:{save:function(){var e=this.get("controller.content"),t=e.saveRecord().then(function(){$.notify("Your changes has been successfully saved.","success")}.bind(this),function(){$.notify("Oooups! Something went wrong.","error")});ApplicationLoader.promise(t)}}}),Vaultier.SettingsPersonalController=Ember.ObjectController.extend({needs:["Settings"]}),Vaultier.SettingsPersonalView=Ember.View.extend({templateName:"Settings/SettingsPersonal"});
Vaultier.SettingsKeysRoute=Ember.Route.extend({renderTemplate:function(){this.render("SettingsKeys",{outlet:"Settings"})},setupController:function(e){e.set("stepInfo",!0),e.set("stepSuccess",!1),e.set("stepKeys",!1),e.get("controllers.Settings").set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addSettings().addText("Regenerate private key"))},actions:{generate:function(){this.set("controller.stepInfo",!1),this.set("controller.stepKeys",!0)},savePrivateKey:function(){var e=this.get("controller.keys.privateKey"),t=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(t,"vaultier.key"),this.set("privateKeySaved",!0)},save:function(e,t){this.set("controller.keys",e);var s=this.get("changekey").changeKey(e).then(function(){this.set("controller.stepKeys",!1),this.set("controller.stepSuccess",!0)}.bind(this)).catch(function(e){$.notify("There was an error during update of your key","error"),this.get("errors").consoleError(e)}.bind(this));ApplicationLoader.promise(s),t.promise=s}}}),Vaultier.SettingsKeysController=Ember.Controller.extend({needs:["Settings"]}),Vaultier.SettingsKeysView=Ember.View.extend({templateName:"Settings/SettingsKeys"});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNoYW5nZUtleS5qcyIsIlNldHRpbmdzSW5kZXguanMiLCJTZXR0aW5nc1BlcnNvbmFsLmpzIiwiU2V0dGluZ3NLZXlzLmpzIl0sIm5hbWVzIjpbIlZhdWx0aWVyIiwiQ2hhbmdlS2V5Q29tcG9uZW50IiwiRW1iZXIiLCJDb21wb25lbnQiLCJleHRlbmQiLCJsYXlvdXROYW1lIiwia2V5cyIsInByaXZhdGVLZXlTYXZlZCIsInB1YmxpY0tleVNhdmVkIiwicHVibGljQnV0dG9uRGlzYWJsZWQiLCJ0aGlzIiwiZ2V0IiwicHJvcGVydHkiLCJkaWRJbnNlcnRFbGVtZW50IiwiRXJyb3IiLCJnZW5lcmF0ZSIsImNoayIsImdlbmVyYXRlS2V5cyIsInNldCIsImJpbmQiLCJhY3Rpb25zIiwic2F2ZVByaXZhdGVLZXkiLCJyYXciLCJibG9iIiwiQmxvYiIsInR5cGUiLCJzYXZlQXMiLCJzYXZlUHVibGljS2V5IiwicmVzdWx0Iiwic2VuZEFjdGlvbiIsInByb21pc2UiLCJjYXRjaCIsImVycm9yIiwiU2V0dGluZ3NSb3V0ZSIsIlJvdXRlIiwiYmVmb3JlTW9kZWwiLCJ0cmFuc2l0aW9uIiwiY2hlY2tBdXRoZW50aWNhdGVkT3JMb2dpbiIsImRlYWN0aXZhdGUiLCJyb2xsYmFjayIsIlNldHRpbmdzVmlldyIsIlZpZXciLCJUYWJWaWV3IiwiY2xhc3NOYW1lQmluZGluZ3MiLCJ3IiwidGFnTmFtZSIsImlzQWN0aXZlIiwidGFiIiwicGF0aCIsInJvdXRlIiwic3BsaXQiLCJsZW5ndGgiLCJ0ZW1wbGF0ZU5hbWUiLCJTZXR0aW5nc0NvbnRyb2xsZXIiLCJDb250cm9sbGVyIiwibmVlZHMiLCJTZXR0aW5nc0luZGV4Um91dGUiLCJhYm9ydCIsInRyYW5zaXRpb25UbyIsIlNldHRpbmdzUGVyc29uYWxSb3V0ZSIsInJlbmRlclRlbXBsYXRlIiwicmVuZGVyIiwib3V0bGV0Iiwic2V0dXBDb250cm9sbGVyIiwiY3RybCIsIkJyZWFkY3J1bWJzIiwiY3JlYXRlIiwicm91dGVyIiwiZW52aXJvbm1lbnQiLCJhZGRIb21lIiwiYWRkU2V0dGluZ3MiLCJhZGRUZXh0Iiwic2F2ZSIsInJlY29yZCIsInNhdmVSZWNvcmQiLCJ0aGVuIiwiJCIsIm5vdGlmeSIsIkFwcGxpY2F0aW9uTG9hZGVyIiwiU2V0dGluZ3NQZXJzb25hbENvbnRyb2xsZXIiLCJPYmplY3RDb250cm9sbGVyIiwiU2V0dGluZ3NQZXJzb25hbFZpZXciLCJTZXR0aW5nc0tleXNSb3V0ZSIsImNoYW5nZUtleSIsImNvbnNvbGVFcnJvciIsIlNldHRpbmdzS2V5c0NvbnRyb2xsZXIiLCJTZXR0aW5nc0tleXNWaWV3Il0sIm1hcHBpbmdzIjoiQUFBQUEsU0FBU0MsbUJBQXFCQyxNQUFNQyxVQUFVQyxRQUMxQ0MsV0FBWSxxQkFFWkMsS0FBTSxLQUNOQyxpQkFBaUIsRUFDakJDLGdCQUFnQixFQUVoQkMscUJBQXNCLFdBQ2xCLE1BQU9DLE1BQUtDLElBQUksb0JBQXNCRCxLQUFLQyxJQUFJLG9CQUNqREMsU0FBUyxrQkFBbUIsa0JBRTlCQyxpQkFBa0IsV0FDZCxJQUFLSCxLQUFLQyxJQUFJLGFBQ1YsS0FBTUcsT0FBTSxnRUFFWEosTUFBS0MsSUFBSSxTQUNWRCxLQUFLSyxZQUliQSxTQUFVLFdBQ04sR0FBSUMsR0FBTU4sS0FBS0MsSUFBSSxZQUNuQkssR0FBSUMsYUFBYSxTQUFVWCxHQUN2QkksS0FBS1EsSUFBSSxPQUFRWixJQUNuQmEsS0FBS1QsUUFHWFUsU0FDSUMsZUFBZ0IsV0FFWixHQUFJQyxHQUFNWixLQUFLQyxJQUFJLG1CQUNmWSxFQUFPLEdBQUlDLE9BQU1GLElBQU9HLEtBQU0sNEJBQ2xDQyxRQUFPSCxFQUFNLGdCQUNiYixLQUFLUSxJQUFJLG1CQUFtQixJQUdoQ1MsY0FBZSxXQUNYakIsS0FBS1EsSUFBSSxrQkFBa0IsRUFDM0IsSUFBSVUsS0FDSmxCLE1BQUttQixXQUFXLFNBQVVuQixLQUFLQyxJQUFJLFFBQVNpQixHQUN4Q0EsRUFBT0UsU0FDUEYsRUFBT0UsUUFDRkMsTUFBTSxTQUFVQyxH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SUFBSSwwQkFBMEIsSUFDckNDLEtBQUtULE9BQ05xQixNQUFNLFNBQVVDLEdBQ2I0QyxFQUFFQyxPQUFPLCtDQUFnRCxTQUN6RG5FLEtBQUtDLElBQUksVUFBVXlFLGFBQWFwRCxJQUNsQ2IsS0FBS1QsTUFFWG9FLG1CQUFrQmhELFFBQVFBLEdBRTFCRixFQUFPRSxRQUFVQSxNQU9qQzlCLFNBQVNxRix1QkFBeUJuRixNQUFNb0QsV0FBV2xELFFBQy9DbUQsT0FBUSxjQUladkQsU0FBU3NGLGlCQUFtQnBGLE1BQU11QyxLQUFLckMsUUFDbkNnRCxhQUFjIiwiZmlsZSI6InNldHRpbmdzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiVmF1bHRpZXIuQ2hhbmdlS2V5Q29tcG9uZW50ID0gRW1iZXIuQ29tcG9uZW50LmV4dGVuZCh7XG4gICAgbGF5b3V0TmFtZTogJ1NldHRpbmdzL0NoYW5nZUtleScsXG5cbiAgICBrZXlzOiBudWxsLFxuICAgIHByaXZhdGVLZXlTYXZlZDogZmFsc2UsXG4gICAgcHVibGljS2V5U2F2ZWQ6IGZhbHNlLFxuXG4gICAgcHVibGljQnV0dG9uRGlzYWJsZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdwdWJsaWNLZXlTYXZlZCcpIHx8ICF0aGlzLmdldCgncHJpdmF0ZUtleVNhdmVkJyk7XG4gICAgfS5wcm9wZXJ0eSgncHJpdmF0ZUtleVNhdmVkJywgJ3B1YmxpY0tleVNhdmVkJyksXG5cbiAgICBkaWRJbnNlcnRFbGVtZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5nZXQoJ2NoYW5nZWtleScpKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignc2VydmljZTpjaGFuZ2VrZXkgaGFzIHRvIGJlIGluamVjdGVkIGludG8gY2hhbmdla2V5IGNvbXBvbmVudCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5nZXQoJ2tleXMnKSkge1xuICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjaGsgPSB0aGlzLmdldCgnY2hhbmdla2V5Jyk7XG4gICAgICAgIGNoay5nZW5lcmF0ZUtleXMoZnVuY3Rpb24gKGtleXMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KCdrZXlzJywga2V5cyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGFjdGlvbnM6IHtcbiAgICAgICAgc2F2ZVByaXZhdGVLZXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHN0YXJ0IGRvd25sb2FkXG4gICAgICAgICAgICB2YXIgcmF3ID0gdGhpcy5nZXQoJ2tleXMucHJpdmF0ZUtleScpO1xuICAgICAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbcmF3XSwge3R5cGU6IFwidGV4dC9wbGFpbjtjaGFyc2V0PXV0Zi04XCJ9KTtcbiAgICAgICAgICAgIHNhdmVBcyhibG9iLCBcInZhdWx0aWVyLmtleVwiKTtcbiAgICAgICAgICAgIHRoaXMuc2V0KCdwcml2YXRlS2V5U2F2ZWQnLCB0cnVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzYXZlUHVibGljS2V5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnNldCgncHVibGljS2V5U2F2ZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuc2VuZEFjdGlvbignYWN0aW9uJywgdGhpcy5nZXQoJ2tleXMnKSwgcmVzdWx0KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wcm9taXNlXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0KCdwdWJsaWNLZXlTYXZlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cbn0pO1xuIiwiVmF1bHRpZXIuU2V0dGluZ3NSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7XG5cbiAgICBiZWZvcmVNb2RlbDogZnVuY3Rpb24gKHRyYW5zaXRpb24pIHtcbiAgICAgICAgLy8gb25seSBhdXRoZW50aWNhdGVkIHVzZXIgY2FuIGFjY2Vzc1xuICAgICAgICBpZiAoIXRoaXMuZ2V0KCdhdXRoJykuY2hlY2tBdXRoZW50aWNhdGVkT3JMb2dpbih0cmFuc2l0aW9uKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGRlYWN0aXZhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5nZXQoJ2F1dGgudXNlcicpLnJvbGxiYWNrKClcbiAgICB9XG5cbn0pXG5cblZhdWx0aWVyLlNldHRpbmdzVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcblxuICAgIFRhYlZpZXc6IEVtYmVyLlZpZXcuZXh0ZW5kKHtcbiAgICAgICAgY2xhc3NOYW1lQmluZGluZ3M6ICdpc0FjdGl2ZTphY3RpdmUnLncoKSxcbiAgICAgICAgdGFnTmFtZTogJ2xpJyxcbiAgICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0YWIgPSB0aGlzLmdldCgndGFiJyk7XG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZ2V0KCdwYXJlbnRWaWV3LmNvbnRyb2xsZXIuY29udHJvbGxlcnMuYXBwbGljYXRpb24uY3VycmVudFBhdGgnKTtcbiAgICAgICAgICAgIHZhciByb3V0ZSA9IHBhdGguc3BsaXQoJy4nKVtwYXRoLnNwbGl0KCcuJykubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICByZXR1cm4gdGFiID09IHJvdXRlO1xuICAgICAgICB9LnByb3BlcnR5KCdwYXJlbnRWaWV3LmNvbnRyb2xsZXIuY29udHJvbGxlcnMuYXBwbGljYXRpb24uY3VycmVudFBhdGgnKVxuICAgIH0pLFxuXG4gICAgdGVtcGxhdGVOYW1lOiAnU2V0dGluZ3MvU2V0dGluZ3NJbmRleCcsXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCdcbn0pO1xuXG5WYXVsdGllci5TZXR0aW5nc0NvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7XG4gICAgbmVlZHM6IFsnYXBwbGljYXRpb24nXVxufSlcblxuVmF1bHRpZXIuU2V0dGluZ3NJbmRleFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKHtcblxuICAgIGJlZm9yZU1vZGVsOiBmdW5jdGlvbiAodHJhbnNpdGlvbikge1xuICAgICAgICB0cmFuc2l0aW9uLmFib3J0KClcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uVG8oJ1NldHRpbmdzLnBlcnNvbmFsJyk7XG4gICAgfVxufSlcbiIsIlZhdWx0aWVyLlNldHRpbmdzUGVyc29uYWxSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChcbiAgICB7XG4gICAgICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcignU2V0dGluZ3NQZXJzb25hbCcsIHtvdXRsZXQ6ICdTZXR0aW5ncyd9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0aW9uIChjdHJsKSB7XG4gICAgICAgICAgICBjdHJsLnNldCgnY29udGVudCcsIHRoaXMuZ2V0KCdhdXRoLnVzZXInKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBicmVhZGNydW1ic1xuICAgICAgICAgICAgY3RybC5nZXQoJ2NvbnRyb2xsZXJzLlNldHRpbmdzJykuc2V0KCdicmVhZGNydW1icycsXG4gICAgICAgICAgICAgICAgVmF1bHRpZXIuQnJlYWRjcnVtYnMuY3JlYXRlKHtyb3V0ZXI6IHRoaXMuZ2V0KCdyb3V0ZXInKSwgZW52aXJvbm1lbnQ6IHRoaXMuZ2V0KCdlbnZpcm9ubWVudCcpfSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZEhvbWUoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkU2V0dGluZ3MoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkVGV4dCgnUGVyc29uYWwgc2V0dGluZ3MnKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhY3Rpb25zOiB7XG4gICAgICAgICAgICBzYXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRoaXMuZ2V0KCdjb250cm9sbGVyLmNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHJlY29yZFxuICAgICAgICAgICAgICAgICAgICAuc2F2ZVJlY29yZCgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnWW91ciBjaGFuZ2VzIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBzYXZlZC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQubm90aWZ5KCdPb291cHMhIFNvbWV0aGluZyB3ZW50IHdyb25nLicsICdlcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uTG9hZGVyLnByb21pc2UocHJvbWlzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH0pO1xuXG5WYXVsdGllci5TZXR0aW5nc1BlcnNvbmFsQ29udHJvbGxlciA9IEVtYmVyLk9iamVjdENvbnRyb2xsZXIuZXh0ZW5kKHtcbiAgICBuZWVkczogWydTZXR0aW5ncyddXG59KTtcblxuVmF1bHRpZXIuU2V0dGluZ3NQZXJzb25hbFZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XG4gICAgdGVtcGxhdGVOYW1lOiAnU2V0dGluZ3MvU2V0dGluZ3NQZXJzb25hbCdcbn0pOyIsIlZhdWx0aWVyLlNldHRpbmdzS2V5c1JvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKFxuICAgIHtcbiAgICAgICAgcmVuZGVyVGVtcGxhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCdTZXR0aW5nc0tleXMnLCB7b3V0bGV0OiAnU2V0dGluZ3MnfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbiAoY3RybCkge1xuICAgICAgICAgICAgY3RybC5zZXQoJ3N0ZXBJbmZvJywgdHJ1ZSk7XG4gICAgICAgICAgICBjdHJsLnNldCgnc3RlcFN1Y2Nlc3MnLCBmYWxzZSk7XG4gICAgICAgICAgICBjdHJsLnNldCgnc3RlcEtleXMnLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIC8vIHNldCBicmVhZGNydW1ic1xuICAgICAgICAgICAgY3RybC5nZXQoJ2NvbnRyb2xsZXJzLlNldHRpbmdzJykuc2V0KCdicmVhZGNydW1icycsXG4gICAgICAgICAgICAgICAgVmF1bHRpZXIuQnJlYWRjcnVtYnMuY3JlYXRlKHtyb3V0ZXI6IHRoaXMuZ2V0KCdyb3V0ZXInKSwgZW52aXJvbm1lbnQ6IHRoaXMuZ2V0KCdlbnZpcm9ubWVudCcpfSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZEhvbWUoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkU2V0dGluZ3MoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkVGV4dCgnUmVnZW5lcmF0ZSBwcml2YXRlIGtleScpXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAgIGdlbmVyYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoJ2NvbnRyb2xsZXIuc3RlcEluZm8nLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoJ2NvbnRyb2xsZXIuc3RlcEtleXMnLCB0cnVlKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHNhdmVQcml2YXRlS2V5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gc3RhcnQgZG93bmxvYWRcbiAgICAgICAgICAgICAgICB2YXIgcmF3ID0gdGhpcy5nZXQoJ2NvbnRyb2xsZXIua2V5cy5wcml2YXRlS2V5Jyk7XG4gICAgICAgICAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbcmF3XSwge3R5cGU6IFwidGV4dC9wbGFpbjtjaGFyc2V0PXV0Zi04XCJ9KTtcbiAgICAgICAgICAgICAgICBzYXZlQXMoYmxvYiwgXCJ2YXVsdGllci5rZXlcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoJ3ByaXZhdGVLZXlTYXZlZCcsIHRydWUpO1xuICAgICAgICAgICAgfSxcblxuXG4gICAgICAgICAgICBzYXZlOiBmdW5jdGlvbiAoa2V5cywgcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoJ2NvbnRyb2xsZXIua2V5cycsIGtleXMpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLmdldCgnY2hhbmdla2V5JylcbiAgICAgICAgICAgICAgICAgICAgLmNoYW5nZUtleShrZXlzKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldCgnY29udHJvbGxlci5zdGVwS2V5cycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0KCdjb250cm9sbGVyLnN0ZXBTdWNjZXNzJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5ub3RpZnkoJ1RoZXJlIHdhcyBhbiBlcnJvciBkdXJpbmcgdXBkYXRlIG9mIHlvdXIga2V5JywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldCgnZXJyb3JzJykuY29uc29sZUVycm9yKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgQXBwbGljYXRpb25Mb2FkZXIucHJvbWlzZShwcm9taXNlKTtcblxuICAgICAgICAgICAgICAgIHJlc3VsdC5wcm9taXNlID0gcHJvbWlzZTtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9KTtcblxuVmF1bHRpZXIuU2V0dGluZ3NLZXlzQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHtcbiAgICBuZWVkczogWydTZXR0aW5ncyddXG59KTtcblxuXG5WYXVsdGllci5TZXR0aW5nc0tleXNWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xuICAgIHRlbXBsYXRlTmFtZTogJ1NldHRpbmdzL1NldHRpbmdzS2V5cydcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==