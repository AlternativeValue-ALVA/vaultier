if(!Po){var Po={};}
Function.prototype.scopize=function(){var fn=this,args=[].slice.call(arguments),object=args.shift();return function(){return fn.apply(object,args.concat([].slice.call(arguments)));};};Po.NS=function(){var len1=arguments.length,i=0,len2,j,ns,sub,current;for(;i<len1;++i){ns=arguments[i].split('.');current=window[ns[0]];if(current===undefined){current=window[ns[0]]={};}
sub=ns.slice(1);len2=sub.length;for(j=0;j<len2;++j){current=current[sub[j]]=current[sub[j]]||{};}}
return current;}
Po.merge=function(o,c,defaults){if(!o){o={};}
if(defaults){$.mergeObject(o,defaults);}
if(o&&c&&typeof c=='object'){for(var p in c){o[p]=c[p];}}
return o;};Po.idSeed=0;Po.generateId=function(prefix){var id=(prefix||"po-id-")+(++Po.idSeed);return id;};Po.NS('Po.O');Po.O.empty=function(mixed_var){var undef,key,i,len;var emptyValues=[undef,null,false,0,"","0"];for(i=0,len=emptyValues.length;i<len;i++){if(mixed_var===emptyValues[i]){return true;}}
if(typeof mixed_var==="object"){for(key in mixed_var){if(mixed_var.hasOwnProperty(key)){return false;}}
return true;}
return false;}
Po.O.evaluate=function(str,exception){var arr=str.split(".");var fn=(window||this);for(var i=0,len=arr.length;i<len;i++){try{fn=fn[arr[i]];}catch(e){fn=false;}}
if(typeof fn!=="function"){fn=false;if(exception){throw new Error("function '#fn#' not found".replace('#fn#',str));}}
return fn;};Po.O.checkInstance=function(variable,cls,msg,exception){exception=Po.F.optional(exception,true);msg=Po.F.optional(msg,'');if(variable instanceof cls){return true;}
if(exception){var name=false;if(cls&&cls.meta&&cls.meta.name){name=cls.meta.name;}
if(name){var msg=msg+' '+' - Given variable must be instance of \'#name#\''.replace('#name#',name);}else{var msg=msg+' '+' - Given variable has wrong type/class';}
throw new Error(msg);}
return false;};Po.O.checkRole=function(object,role,msg,exception){exception=Po.F.optional(exception,true);msg=Po.F.optional(msg,'');if(object&&object.meta&&object.meta.does(role)){return true;}
if(exception){var name=false;if(role&&role.meta&&role.meta.name){name=role.meta.name;}
if(name){var msg=msg+' '+' - Given object must have role \'#name#\''.replace('#name#',name);}else{var msg=msg+' '+' - Given object has wrong role';}
throw new Error(msg);}
return false;};Po.NS('Po.A');Po.A.each=function(items,fn,scope){if(scope instanceof Object){fn=fn.scopize(scope);}
if(items instanceof Array){return each=Joose.A.each(items,fn);}
if(items instanceof jQuery){return items.each(function(key,value){return fn(value,key);});}
if(items instanceof Object&&typeof items.each=='function'){return items.each(fn);}
if(items instanceof Object){return Joose.O.eachOwn(items,fn);}
throw Error('Unsupported object to "each"');}
Po.NS('Po.F');Po.F.optional=function(variable,defaultize){if(typeof variable=='undefined'){variable=defaultize;}
return variable;}
Po.F.throttle=function(interval,callback,context){f=function self(){self.throttle.fire();};f.throttle=new Po.Async.Throttle({interval:interval,callback:callback,context:context});return f;}
Po.F.delay=function(delay,callback,context,resetting){return function self(){var args=Array.prototype.slice.apply(arguments);if(resetting){window.clearTimeout(self.timeout);}
self.timeout=window.setTimeout(function(){callback.apply(context,args);},delay);};}
Po.F.map=function(delay,callback,context,resetting){return function self(){var args=Array.prototype.slice.apply(arguments);if(resetting){window.clearTimeout(self.timeout);}
self.timeout=window.setTimeout(function(){callback.apply(context,args);},delay);};}
Po.NS('Po.S');Po.S.ucfirst=function(str){if(typeof str!=='string'){throw Error('String parameter is expected');}
str+='';var f=str.charAt(0).toUpperCase();return f+str.substr(1);}
Po.NS('Po.paths');Po.paths.root=function(){var scripts=document.getElementsByTagName('script');var index=scripts.length-1;var url=scripts[index].src;var a=document.createElement('a');a.href=url;return a.pathname.replace('Pohon/Pohon.js','');}();Po.log=function(message){console.log(message);}
Po.error=function(error){var msg;if(error instanceof Error){msg=error.stack;if(!msg){msg=error.message;}}
if(!msg){msg=error;}
console.error(msg);}
Po.warning=function(message){console.warning(message);}
Po.NS('Po.form');Po.form.serializeObject=function(form){var o={};var a=form.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{if(this.name.indexOf('[]')!=-1){o[this.name]=[this.value||''];}else{o[this.name]=this.value||'';}}});return o;};Po.NS('Po.check');Po.check.Array=function(what){if(Array.isArray)
return Array.isArray(what);return(Object.prototype.toString.call(someVar)==='[object Array]');};Po.check.Object=function(what){var t=typeof what;return(t=='object'&&what!=null||t=='function');};Po.NS('Po.R');Po.R.randomFloat=function(min,max){return Math.random()*(max-min)+min;}
Po.R.randomInt=function(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
Po.R.randomString=function(min,max){min=Po.F.optional(min,5);max=Po.F.optional(max,20);length=Po.R.randomInt(min,max);var text="";var possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<length;i++)
text+=possible.charAt(Math.floor(Math.random()*possible.length));return text;}
Po.R.randomEmail=function(){return(Po.R.randomString(3,10)+'@'+Po.R.randomString(3,15)+'.'+Po.R.randomString(3,3)).toLowerCase();}
ldd=function(o){Po.log(o);throw'Javascript stopped';}
ld=function(o){Po.log(o);}
if(!Array.prototype.map){Array.prototype.map=function(callback,thisArg){var T,A,k;if(this==null){throw new TypeError(" this is null or not defined");}
var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function"){throw new TypeError(callback+" is not a function");}
if(thisArg){T=thisArg;}
A=new Array(len);k=0;while(k<len){var kValue,mappedValue;if(k in O){kValue=O[k];mappedValue=callback.call(T,kValue,k,O);A[k]=mappedValue;}
k++;}
return A;};}
Po.NS('Utils')
Utils.Singleton=Ember.Mixin.create({current:function(){if(!this._current){this._current=this.createCurrent();}
return this._current;},createCurrent:function(){return this.create({});},currentProp:function(property,value){var instance=this.current();if(!instance){return;}
if(typeof(value)!=="undefined"){instance.set(property,value);return value;}else{return instance.get(property);}}});Po.NS('Utils')
Utils.HandlebarsHelpers=Ember.Object.extend({register:function(){Ember.Handlebars.registerBoundHelper('ucfirst',function(value){if(value){value=value.charAt(0).toUpperCase()+value.slice(1);}
return value;});Ember.Handlebars.registerBoundHelper('gravatar',function(email,options){var email=context;var size=(typeof(options.hash.size)==="undefined")?32:options.hash.size;return"http://www.gravatar.com/avatar/"+CryptoJS.MD5(email)+"?s="+size;});Ember.Handlebars.registerBoundHelper('gravatarImg',function(email,options){var size=(typeof(options.hash.size)==="undefined")?32:options.hash.size;var result='<img class="'+options.hash.class+'" src="http://www.gravatar.com/avatar/'+CryptoJS.MD5(email)+'?s='+size+'" />';return new Ember.Handlebars.SafeString(result);});Ember.Handlebars.registerBoundHelper('ellipsis',function(str,limit,append){if(typeof append!=='string'){append='...';}
if(!str){str='';}
var sanitized=str.replace(/(<([^>]+)>)/g,'');if(sanitized.length>limit){var r=sanitized.substr(0,limit-append.length)+append;return r;}else{return sanitized;}});Ember.Handlebars.registerBoundHelper("ifCond",function(v1,operator,v2,options){switch(operator){case"==":return(v1==v2)?options.fn(this):options.inverse(this);case"!=":return(v1!=v2)?options.fn(this):options.inverse(this);case"===":return(v1===v2)?options.fn(this):options.inverse(this);case"!==":return(v1!==v2)?options.fn(this):options.inverse(this);case"&&":return(v1&&v2)?options.fn(this):options.inverse(this);case"||":return(v1||v2)?options.fn(this):options.inverse(this);case"<":return(v1<v2)?options.fn(this):options.inverse(this);case"<=":return(v1<=v2)?options.fn(this):options.inverse(this);case">":return(v1>v2)?options.fn(this):options.inverse(this);case">=":return(v1>=v2)?options.fn(this):options.inverse(this);default:return eval(""+v1+operator+v2)?options.fn(this):options.inverse(this);}});}})
Po.NS('Utils');Utils.ErrorAwareRouteMixin=Ember.Mixin.create({transitionToLogin:function(transition){this.transitionTo('AuthLogin');},handleErrors:function(transition){return function(error){transition.abort();console.error('Handled model error --'+error.status+'-- ('+error.message+')');var showError=function(url){Ember.run.join(transition.router,function(){this.handleURL(url);});}
switch(error.status){case 403:{showError('/errors/error-403');break;}
case 404:{showError('/errors/error-404');break;}
case 401:{this.transitionToLogin(transition);break;}
default:{showError('/errors/error-400');break;}}}.bind(this);}})
LGTM.configure('defer',Ember.RSVP.defer);$.notify.defaults({className:'success',style:'bootstrap',position:'top center'})
Ember.FEATURES["query-params"]=true
Vaultier=Ember.Application.create({LOG_TRANSITIONS:true});Utils.HandlebarsHelpers.create().register();$.cookie.json=true;Po.NS('Vaultier.config');Vaultier.config.authPersistTTL=0;Ember.RSVP.configure('onerror',function(error){console.error(error.message);console.error(error.stack);});Vaultier.Store=DS.Store.extend({loadMore:function(type,query){query=typeof query=='object'?query:{};return this._super(type,query);},loadOne:function(type,id){type=this.modelFor(type);var record=this.recordForId(type,id);if(record.currentState.stateName!='root.empty'&&reload){return record.reload()}else{return this.findById(type,id);}}});Vaultier.ApplicationAdapter=DS.DjangoRESTAdapter.extend({urls:{AuthenticatedUser:'/api/auth/user'},ajaxError:function(error){var superError=this._super(error);superError.status=error.status;return superError;},buildURL:function(type,id){if(this.urls[type]){url=this.urls[type];if(id){if(url.charAt(url.length-1)!=='/'){url+='/';}
url=url+id;}
return url;}else{return this._super(type,id)}},namespace:'api'});Po.NS('Service');Service.Environment=Ember.Object.extend({workspace:null,vault:null,card:null,secret:null});Service.Environment.reopenClass(Utils.Singleton);Po.NS('Service');Service.Auth=Ember.Object.extend({init:function(){this._super(arguments);this.store=Vaultier.__container__.lookup('store:main');this.session=Service.Session.current();this.promises=Service.AuthPromises.create()},store:null,session:null,storage:null,callbacks:[],token:null,user:null,checked:false,privateKey:null,isAuthenticated:function(){return this.get('user.id')!==null}.property('user'),isChecked:function(){return this.get('checked')==true}.property('user','checked'),login:function(email,privateKey){return this.promises.login(email,privateKey).then(function(user){this.setAuthenticatedUser(user,privateKey,this.promises.get('token'))}.bind(this),function(){this.setAuthenticatedUser(null)
return Ember.RSVP.reject()}.bind(this))},reload:function(){var session=this.loadFromSession()||{};var sessionUser=session.user||null;var sessionPrivateKey=session.privateKey||null;var sessionToken=session.token||null;this.promises._useToken()(sessionToken);this.setAuthenticatedUser(sessionUser,sessionPrivateKey,sessionToken)
return Ember.RSVP.resolve();},logout:function(){return this.promises.logout().then(function(){this.setAuthenticatedUser(null);}.bind(this))},afterAuthenticated:function(callback){this.callbacks.push(callback);callback(this.status);},setAuthenticatedUser:function(user,privateKey,token){var result;if(user&&privateKey&&token){result=true;this.setProperties({checked:true,isAuthenticated:true,user:user,privateKey:privateKey,token:token})}else{result=false;this.setProperties({checked:true,isAuthenticated:false,user:null,privateKey:null,token:null})}
this.saveToSession();this.callbacks.forEach(function(c){c(this);}.bind(this));return result;},saveToSession:function(){var email=this.get('user')?this.get('user').email:null;this.session.set('auth',{token:this.get('token'),email:email,user:this.get('user'),privateKey:this.get('privateKey')});},loadFromSession:function(){return this.session.get('auth');},deleteFromSession:function(){this.session.remove('auth');},saveToStorage:function(ttl){this.storage.set('auth',{email:this.get('user').get('email'),privateKey:this.get('privateKey')},ttl);},loadFromStorage:function(){return this.storage.get('auth');},deleteFromStorage:function(){this.storage.remove('auth');}});Service.Auth.reopenClass(Utils.Singleton);Service.AuthPromises=Ember.Object.extend({token:null,_auth:function(email,privateKey){return function(password){return Ember.RSVP.Promise(function(resolve,reject){var coder=Service.Coder.create();var signature=coder.sign(email,privateKey);Ember.$.ajax({url:'/api/auth/auth',type:'post',data:{email:email,signature:signature}}).then(function(response){resolve(response.token);},function(){console.error('Auth call unsuccessfull');reject();});});}},_retrieveUser:function(){return function(){return Ember.RSVP.Promise(function(resolve,reject){Ember.$.ajax({url:'/api/auth/user',type:'get'}).then(function(user){resolve(user);},function(error){console.error('User cannot be retrieved');reject(error);})});}},_useToken:function(){return function(token){Ember.$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader('X-Vaultier-Token',token);}});this.set('token',token);return Ember.RSVP.resolve();}.bind(this);},_resetToken:function(){return function(){Ember.$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader('X-Vaultier-Token','');}});this.set('token',null)
return Ember.RSVP.resolve();}.bind(this);},_unauth:function(){return function(){return Ember.RSVP.Promise(function(resolve,reject){Ember.$.ajax({url:'/api/auth/logout',type:'post'}).always(function(){resolve();});});}},user:function(){return Ember.RSVP.resolve().then(this._retrieveUser(token))},logout:function(){return Ember.RSVP.resolve().then(this._unauth()).then(this._resetToken())},login:function(email,privateKey){return Ember.RSVP.resolve().then(this._auth(email,privateKey)).then(this._useToken()).then(this._retrieveUser())}});Po.NS('Service');Service.Session=Ember.CoreObject.extend({init:function(){if(!window.sessionStorage){throw'Vaultier requires sessionStorage to be supported by browser'}},prefix:'vaultier.',set:function(key,value){Ember.$(document).sessionStorage(this.prefix+key,value);},get:function(key){return Ember.$(document).sessionStorage(this.prefix+key);},remove:function(key){return Ember.$(document).sessionStorage(this.prefix+key,null);}});Service.Session.reopenClass(Utils.Singleton);Po.NS('Service');Service.Coder=Ember.Object.extend({generateKeys:function(callback){var build=function(){return{privateKey:generator.getPrivateKey(),publicKey:generator.getPublicKey()}}
var generator=new JSEncrypt({default_key_size:1024});if(callback){generator.getKey(function(){callback(build())});}else{generator.getKey()
return build();}},sign:function(value,privateKey){var rsa=new RSAKey();rsa.readPrivateKeyFromPEMString(privateKey);var signature=hex2b64(rsa.signString(value,'sha1'));return signature;},decrypt:function(value,privateKey){var decoder=new JSEncrypt();decoder.setPrivateKey(privateKey);var result=decoder.decrypt(value);return result;}});var CreatedUpdatedMixin=Ember.Mixin.create({created_at:DS.attr('date'),updated_at:DS.attr('date'),updated_ago:function(){var u=this.get('updated_at');var t;try{t=moment(u).fromNow();}catch(e){console.error(e.stack)}
return t;}.property('updated_at'),created_ago:function(){var u=this.get('created_at');var t;try{t=moment(u).fromNow();}catch(e){console.error(e.stack)}
return t;}.property('created_at')});Vaultier.User=DS.Model.extend(CreatedUpdatedMixin,{email:DS.attr('string'),nickname:DS.attr('string')})
Vaultier.AuthenticatedUser=Vaultier.User.extend({public_key:DS.attr('string')});Vaultier.Workspace=DS.Model.extend(CreatedUpdatedMixin,{name:DS.attr('string'),vaults:DS.attr('number'),description:DS.attr('string'),created_by:DS.attr()});Vaultier.Vault=DS.Model.extend(CreatedUpdatedMixin,{name:DS.attr('string'),workspace:DS.attr('number'),description:DS.attr('string'),created_by:DS.attr()});Vaultier.Card=DS.Model.extend(CreatedUpdatedMixin,{name:DS.attr('string'),description:DS.attr('string'),vault:DS.attr('number'),created_by:DS.attr()});Vaultier.Secret=DS.Model.extend(CreatedUpdatedMixin,{types:{note:1,password:2,file:3},name:DS.attr('string'),type:DS.attr('number'),data:DS.attr('string'),card:DS.attr('number'),created_by:DS.attr(),password:null,username:null,url:null,note:null,file:null,decode:function(){var data=this.get('data');var data=JSON.parse(data);this.setProperties(data);},encode:function(){var data;switch(this.get('type')){case this.types.note:{data=this.getProperties('note');break;}
case this.types.password:{data=this.getProperties('password','url','note','username');break;}
case this.types.file:{data=this.getProperties('file','url','note','username');break;}
default:{throw'Unspecified secret type cannot be encoded';}}
this.set('data',JSON.stringify(data));},didLoad:function(){this.decode();return this._super(arguments);},didReload:function(){this.decode();return this._super(arguments);},save:function(){this.encode();return this._super(arguments);}});Vaultier.LayoutLayoutStandardView=Ember.View.extend({templateName:'Layout/LayoutStandard'});Vaultier.LayoutLayoutWindowView=Ember.View.extend({templateName:'Layout/LayoutStandard'});Po.NS('Vaultier.Layout');Vaultier.LayoutSecurityBoxView=Ember.View.extend({tagName:'span',templateName:'Layout/SecurityBox',actions:{logout:function(){var auth=Service.Auth.current();auth.logout().then(function(){$.notify('You have been successfully logged out.','success');var ctrl=this.get('controller');ctrl.transitionToRoute('index');}.bind(this));}}});Vaultier.LayoutSecurityBoxController=Ember.Controller.extend({auth:null,init:function(){this._super(arguments);this.auth=Service.Auth.current();}});Vaultier.Breadcrumbs=Ember.Object.extend({items:null,normalize:function(params){return params;},addLink:function(link,title,params){this.items=this.items||[];this.items.forEach(function(item){delete item.last});if(link){try{if(params){params=this.normalize(params);link=this.router.generate(link,[params])}else{link=this.router.generate(link)}}catch(e){console.error(e.message);console.error('Breadcrumbs error during generate route ('+route+')');}}
this.items.push({link:link,title:title,last:true})
return this;},addText:function(text){this.addLink(null,text);return this;},addHome:function(){this.addLink('index','Home');return this;},addVault:function(){var vault=Service.Environment.current().vault;if(vault){this.addLink('Card.index',vault.get('name'),[vault.get('id')])}
return this;},addCard:function(){var card=Service.Environment.current().card;if(card){this.addLink('Secret.index',card.get('name'),[card.get('id')])}
return this;},addWorkspace:function(){var workspace=Service.Environment.current().workspace;if(workspace){this.addLink('Vault.index',workspace.get('name'),[workspace.get('id')])}
return this;}})
Po.NS('Vaultier.Layout');Vaultier.LayoutWorkspaceBoxController=Ember.Controller.extend({env:null,init:function(){this._super();this.env=Service.Environment.current();}})
Vaultier.LayoutWorkspaceBoxView=Ember.View.extend({tagName:'span',templateName:'Layout/WorkspaceBox'});Vaultier.LayoutConfirmView=Ember.View.extend({templateName:'Layout/Confirm',didInsertElement:function(){var el=Ember.$(this.get('element')).find('.modal');el.modal('show');el.one('hidden.bs.modal',function(){this.get('controller.route').disconnectOutlet({parent:'application',outlet:'modal'});}.bind(this));},show:function(options){var ctrl=options.route.get('container').lookup('controller:LayoutConfirm');ctrl.setProperties(options);options.route.render('LayoutConfirm',{into:'application',outlet:'modal',controller:'LayoutConfirm'});},actions:{ok:function(){var fn=this.get('controller.fn');var el=Ember.$(this.get('element')).find('.modal');el.one('hidden.bs.modal',fn);el.modal('hide');}}});Vaultier.LayoutConfirmController=Ember.Controller.extend({text:null,fn:null,route:null,fn:null})
Vaultier.confirmModal=function(route,text,fn){var view=route.container.lookup('view:LayoutConfirm');view.show({title:'Confirmation',text:text,route:route,fn:fn});}
Vaultier.HomeRoute=Ember.Route.extend({redirect:function(){this.transitionTo('Home.index');}});Vaultier.HomeIndexRoute=Ember.Route.extend({});Vaultier.HomeIndexController=Ember.ArrayController.extend({});Vaultier.HomeIndexView=Ember.View.extend({templateName:'Home/HomeIndex',layoutName:'Layout/LayoutStandard'});Vaultier.Error400View=Ember.View.extend({templateName:'Error/Error400',layoutName:'Layout/LayoutStandard'});Vaultier.Error403View=Ember.View.extend({templateName:'Error/Error403',layoutName:'Layout/LayoutStandard'});Vaultier.Error404View=Ember.View.extend({templateName:'Error/Error404',layoutName:'Layout/LayoutStandard'});var LoginProps=Ember.Object.extend({init:function(){this._super(arguments);var session=Service.Session.current();},rememberOptions:[{ttl:0,text:'Do not remember'},{ttl:1,text:'Remember for one day'},{ttl:7,text:'Remember for one week'},{ttl:30,text:'Remember for one month'},{ttl:365,text:'Remember for one year'},],latestUser:null});LoginProps.reopenClass(Utils.Singleton);var selectTab=function(){var step=this.controller.get('tab');var el=Ember.$('body');$(el).find('.vlt-login-tabs li.active').removeClass('active');$(el).find('.vlt-login-tabs li.'+step).addClass('active');}
Vaultier.AuthLoginIndexController=Ember.Controller.extend({props:LoginProps.current()});Vaultier.AuthLoginView=Ember.View.extend({templateName:'Auth/AuthLogin',layoutName:'Layout/LayoutStandard',});Vaultier.AuthLoginIndexRoute=Ember.Route.extend({redirect:function(){if(LoginProps.current().get('latestUser')){this.transitionTo('AuthLogin.latest')}else{this.transitionTo('AuthLogin.switch')}}});Vaultier.AuthLoginSwitchRoute=Ember.Route.extend({renderTemplate:function(){this.render('AuthLoginSwitch',{outlet:'AuthLogin'})},setupController:function(ctrl){ctrl.set('email','jan.misek@rclick.cz');ctrl.set(''
+'privateKey','-----BEGIN RSA PRIVATE KEY-----'
+'MIICWgIBAAKBgGcpfqrh++lSMRIaqhveIcDMwMklT+y2w6iIO5aJitEPXkT/XkwH'
+'bmfNOTA982ndTh7bEntnAKV0hAJYn8iLjLOGbBLA+lJKSZB8g0CEh2Rqkaf1aAyj'
+'Iqt7huYcGdjSCOdQb2FICYB15FF6IFxBU5rwqcq3nIjDnitQRujzod6NAgMBAAEC'
+'gYAZbS/MPIDThC+WD75nuftFwvGtYiXt6SoWauWM9/+gAZKxnOOIB7jdmsaCrnJF'
+'YId1sXc/tSaCoVI8Jc3UJxkZgXuXn6gu9xdpywtB7J+i3Lp+XengQM0Sy2C75S65'
+'rDaaMqirFYTtSvyIauaqhIgRujAVTvXh3z/HPs4/R5eK/QJBAL0VGj//kYh7oCdl'
+'3AvMIxHNCHs2o03FiP5iwtKjbCuT7wuI2E3HGexCVndk1O9q8eGPYrk1l8KMzEDd'
+'Xg6M/a8CQQCLq/73Tpzzd61x3PQDTSoLMzpPagkLG9BW07v888m2miTMlMr3sRbO'
+'MiW/P55oc63LKfIYsRE41AetrtSj5lKDAkAQrczb+lpHFMii0QxhCgfJ6TEnVUGA'
+'eb1E20deN0YybeE3PkH+UmLKAWwJKh7SY7ekcvZ9aenSIoNd8Wj7lZpHAkB2jLRK'
+'oNUi6a+z94C91J8dBow1n6CxZxg8ulbTavEJJmiZpKlp90uOFI5pd8wyiA05Zg7w'
+'2knt3DnwN3aQ7wuVAkAFtkrckXd/O2RK9L4Ksp7oBE4vULB8lvnXcx8N4E3OyPRP'
+'MkHV8DG6BLWpz7vlPR3DkTWrCSp7lURhkqIztiau'
+'-----END RSA PRIVATE KEY-----')},actions:{login:function(){var ctrl=this.get('controller');var email=ctrl.get('email');var privateKey=ctrl.get('privateKey');var auth=Service.Auth.current();auth.login(email,privateKey).then(function(){$.notify('You have been successfully logged in.','success');this.transitionTo('index');}.bind(this),function(){$.notify('We are sorry, but your login failed','error');this.get('controller').set('props.latestUser',null);}.bind(this));}}});Vaultier.AuthLoginSwitchController=Ember.Controller.extend({tab:'AuthLoginSwitch',privateKey:null,filaneme:null,email:null,error:false,emailSuccess:false,props:LoginProps.current(),validate:function(){var validator=LGTM.validator().validates('email').email('Not an email').required('Required field').validates('privateKey').required('Required field').build()
validator.validate(this).then(function(result){this.set('isValid',result.valid)
this.set('emailSuccess',!result.errors.email.length&&!this.get('error'))}.bind(this));return false;}.observes('email','privateKey','error'),loginButtonDisabled:function(){return!this.get('isValid')}.property('isValid')});Vaultier.AuthLoginSwitchView=Ember.View.extend({templateName:'Auth/AuthLoginSwitch',didInsertElement:function(){selectTab.call(this);this._super(arguments);var el=$(this.get('element'));var input=el.find('.vlt-login-key').get(0);var controller=this.controller;$(el).on('change',function(e){var files=FileAPI.getFiles(e);FileAPI.readAsText(files[0],function(evt){if(evt.type=='load'){controller.set('privateKey',evt.result);controller.set('filename',files[0].name);}})})}});Vaultier.AuthLoginLatestRoute=Ember.Route.extend({tab:'AuthLoginLatest',renderTemplate:function(){this.render('AuthLoginLatest',{outlet:'AuthLogin'})},actions:{login:function(){var ctrl=this.get('controller');var latestUser=ctrl.get('props.latestUser');var auth=Service.Auth.current();auth.auth({persist:true,persistTTL:latestUser.ttl,email:latestUser.user,privateKey:latestUser.key}).then(function(){$.notify('You have been successfully logged in.','success');this.transitionTo('index');}.bind(this),function(){$.notify('We are sorry, but your login failed','error');ctrl.set('error',true);}.bind(this));}}});Vaultier.AuthLoginLatestController=Ember.Controller.extend({tab:'AuthLoginLatest',props:LoginProps.current()});Vaultier.AuthLoginLatestView=Ember.View.extend({didInsertElement:selectTab,templateName:'Auth/AuthLoginLatest',});var RegisterProps=Ember.Object.extend({nextButtonTitle:false,nextButtonDisable:false,keysReady:false,keys:null,loginButtonHidden:false});RegisterProps.reopenClass(Utils.Singleton);var BaseRegisterController=Ember.Controller.extend({props:RegisterProps.current()});Vaultier.AuthRegisterView=Ember.View.extend({templateName:'Auth/AuthRegister',layoutName:'Layout/LayoutStandard',TabView:Ember.View.extend({classNameBindings:'isActive:active'.w(),tagName:'li',isActive:function(){var tab=this.get('tab');var path=this.get('parentView.controller.controllers.application.currentPath');var route=path.split('.')[path.split('.').length-1];return tab==route;}.property('parentView.controller.controllers.application.currentPath')})});Vaultier.AuthRegisterController=BaseRegisterController.extend({needs:['application']});Vaultier.AuthRegisterRoute=Ember.Route.extend({beforeModel:function(transition){if(Service.Auth.current().get('isAuthenticated')){transition.router.replaceWith('AuthRegister.sum');}else{transition.router.replaceWith('AuthRegister.before');}}});Vaultier.AuthRegisterBeforeRoute=Ember.Route.extend({step:'AuthRegisterBefore',beforeModel:function(transition){if(Service.Auth.current().get('isAuthenticated')){transition.router.replaceWith('AuthRegister.sum');}},setupController:function(ctrl){ctrl.set('props.loginButtonHidden',false);ctrl.set('props.nextButtonDisabled',false);ctrl.set('props.nextButtonTitle',null)},renderTemplate:function(){this.render(this.step,{outlet:'AuthRegister'})},actions:{next:function(){this.transitionTo('AuthRegister.keys');}}});Vaultier.AuthRegisterBeforeView=Ember.View.extend({templateName:'Auth/AuthRegisterBefore'});Vaultier.AuthRegisterBeforeController=BaseRegisterController.extend();Vaultier.AuthRegisterKeysController=BaseRegisterController.extend();Vaultier.AuthRegisterKeysRoute=Ember.Route.extend({step:'AuthRegisterKeys',beforeModel:function(transition){if(Service.Auth.current().get('isAuthenticated')){transition.router.replaceWith('AuthRegister.sum');}},renderTemplate:function(){this.render(this.step,{outlet:'AuthRegister'})},actions:{next:function(){this.transitionTo('AuthRegister.creds');},downloadKey:function(){var ctrl=this.get('controller');var blob=new Blob([ctrl.get('props.keys.privateKey')],{type:"text/plain;charset=utf-8"});saveAs(blob,"vaultier.key");ctrl.set('props.nextButtonDisabled',false);}},setupController:function(ctrl){ctrl.set('props.loginButtonHidden',false);ctrl.set('props.nextButtonTitle',null)
if(!ctrl.get('props.keysReady')){ctrl.set('props.nextButtonDisabled',true);var coder=Service.Coder.create();coder.generateKeys(function(keys){ctrl.set('props.keys',keys);ctrl.set('props.keysReady',true);}.bind(this));}}});Vaultier.AuthRegisterKeysView=Ember.View.extend({templateName:'Auth/AuthRegisterKeys'});Vaultier.AuthRegisterCredsRoute=Ember.Route.extend({step:'AuthRegisterCreds',beforeModel:function(transition){if(Service.Auth.current().get('isAuthenticated')){transition.router.replaceWith('AuthRegister.sum');}},renderTemplate:function(){this.render(this.step,{outlet:'AuthRegister'})},setupController:function(ctrl){this._super(arguments);ctrl.set('props.loginButtonHidden',false);ctrl.set('props.nextButtonDisabled',false);ctrl.set('props.nextButtonTitle','Sumit your credentials');var user=ctrl.get('content');if(!user){var user=this.get('store').createRecord('AuthenticatedUser');ctrl.set('content',user);}
if(!ctrl.get('props.keysReady')){this.transitionTo('AuthRegister');}},actions:{next:function(){var auth=Service.Auth.current();var ctrl=this.get('controller');var user=ctrl.get('content');var keys=ctrl.get('props.keys');if(user.get('currentState').stateName!='root.loaded.created.invalid'){user.set('public_key',keys.publicKey);ctrl.set('props.nextButtonDisabled',true);var promise=user.save();promise.then(function(){return auth.login(user.get('email'),keys.privateKey).then(function(){this.transitionTo('AuthRegister.sum');}.bind(this));}.bind(this),function(errors){ctrl.set('errors',Ember.Object.create(errors.errors));ctrl.set('props.nextButtonDisabled',false);}.bind(this));}}}});Vaultier.AuthRegisterCredsController=BaseRegisterController.extend({init:function(){this._super(arguments)
this.set('props.nextButtonTitle','Create your account')}});Vaultier.AuthRegisterCredsView=Ember.View.extend({templateName:'Auth/AuthRegisterCreds'});Vaultier.AuthRegisterSumRoute=Ember.Route.extend({step:'AuthRegisterSum',renderTemplate:function(){this.render(this.step,{outlet:'AuthRegister'})},setupController:function(ctrl){this._super(arguments);ctrl.set('props.loginButtonHidden',true);ctrl.set('props.nextButtonDisabled',false);ctrl.set('props.nextButtonTitle','Start using vaultier')
ctrl.set('auth',Service.Auth.current());},actions:{downloadKey:function(){var blob=new Blob([Service.Auth.current().get('privateKey')],{type:"text/plain;charset=utf-8"});saveAs(blob,"vaultier.key");},next:function(){this.transitionTo('index');}}});Vaultier.AuthRegisterSumController=BaseRegisterController.extend({auth:null});Vaultier.AuthRegisterSumView=Ember.View.extend({templateName:'Auth/AuthRegisterSum'});Vaultier.WorkspaceRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{beforeModel:function(transition){if(!Service.Auth.current().get('isAuthenticated')){$.notify('You do not have access to secured area. Please login','error');transition.abort();this.transitionToLogin(transition);}}});Vaultier.WorkspaceIndexRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var store=this.get('store');var promise=store.find('Workspace');promise.then(null,this.handleErrors(transition))
return promise;},setupController:function(ctrl,model){this._super(ctrl,model);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addText('List of workspaces'));}});Vaultier.WorkspaceIndexController=Ember.ArrayController.extend({});Vaultier.WorkspaceIndexView=Ember.View.extend({templateName:'Workspace/WorkspaceIndex',layoutName:'Layout/LayoutStandard'});Vaultier.WorkspaceIndexItemView=Ember.View.extend({templateName:'Workspace/WorkspaceIndexItem'});Vaultier.WorkspaceCreateRoute=Ember.Route.extend({actions:{save:function(){var record=this.get('controller.content');record.save().then(function(){$.notify('You workspace has been successfully created.','success');this.transitionTo('Vault.index',record);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},setupController:function(ctrl,model){this._super(ctrl,model);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addText('Create new workspace'))},model:function(params){var store=this.get('store');var record=store.createRecord('Workspace');return record;},deactivate:function(){var record=this.get('controller.content');if(!record.get('id')){var store=this.get('store');store.deleteRecord(record);}}});Vaultier.WorkspaceCreateController=Ember.ObjectController.extend({breadcrumbs:null});Vaultier.WorkspaceCreateView=Ember.View.extend({templateName:'Workspace/WorkspaceCreate',layoutName:'Layout/LayoutStandard'});Vaultier.WorkspaceEditRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var store=this.get('store');var promise=store.find('Workspace',params.workspace);promise.then(null,this.handleErrors(transition))
return promise;},setupController:function(ctrl,model){this._super(ctrl,model);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addText('Edit workspace'))},actions:{save:function(){var record=this.get('controller.content');record.save().then(function(){$.notify('Your changes has been successfully saved.','success');history.go(-1);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},});Vaultier.WorkspaceEditController=Ember.ObjectController.extend({breadcrumbs:null});Vaultier.WorkspaceEditView=Ember.View.extend({templateName:'Workspace/WorkspaceEdit',layoutName:'Layout/LayoutStandard'});Vaultier.VaultRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var promise=this.get('store').find('Workspace',params.workspace);promise.then(null,this.handleErrors(transition))
return promise;},afterModel:function(workspace){Service.Environment.current().set('workspace',workspace);},deactivate:function(){Service.Environment.current().set('workspace',null);},serialize:function(model){return{workspace:model.get('id')}}});Vaultier.VaultIndexRoute=Ember.Route.extend({workspace:null,model:function(params,queryParams){var store=this.get('store');return store.find('Vault');},setupController:function(ctrl,vaults){ctrl.set('content',vaults);var workspace=this.modelFor('Vault');this.set('workspace',workspace);ctrl.set('workspace',workspace);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addText('List of vaults'))}});Vaultier.VaultIndexController=Ember.ArrayController.extend({sortProperties:['name'],sortAscending:true,breadcrumbs:null,actions:{createVault:function(){this.set('sortAscending',!this.get('sortAscending'));}}});Vaultier.VaultIndexView=Ember.View.extend({templateName:'Vault/VaultIndex',layoutName:'Layout/LayoutStandard'});Vaultier.VaultIndexItemView=Ember.View.extend({templateName:'Vault/VaultIndexItem'});Vaultier.VaultCreateRoute=Ember.Route.extend({workspace:null,actions:{save:function(){var workspace=this.get('workspace');var record=this.get('controller.content');record.set('workspace',this.get('workspace').id)
record.save().then(function(){$.notify('Your vault has been successfully created.','success');this.transitionTo('Card.index',workspace.id,record.id);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},setupController:function(ctrl,model){this._super(ctrl,model);var workspace=this.modelFor('Vault');this.set('workspace',workspace);this.get('controller').set('workspace',workspace);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addText('Create new vault'))},model:function(params,queryParams){var store=this.get('store');var record=store.createRecord('Vault');return record;},deactivate:function(){var record=this.get('controller.content');if(!record.get('id')){var store=this.get('store');store.deleteRecord(record);}}});Vaultier.VaultCreateController=Ember.ObjectController.extend({workspace:null,breadcrumbs:null,env:null});Vaultier.VaultCreateView=Ember.View.extend({templateName:'Vault/VaultCreate',layoutName:'Layout/LayoutStandard'});Vaultier.VaultEditRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{serialize:function(vault){return{vault:vault.id}},model:function(params,transition){var store=this.get('store');var promise=store.find('Vault',params.vault);promise.then(null,this.handleErrors(transition))
return promise;},setupController:function(ctrl,model){this._super(ctrl,model);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addText('Edit vault'))},actions:{save:function(){var record=this.get('controller.content');record.save().then(function(){$.notify('Your changes has been successfully saved.','success');history.go(-1);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},});Vaultier.VaultEditController=Ember.ObjectController.extend({breadcrumbs:null});Vaultier.VaultEditView=Ember.View.extend({templateName:'Vault/VaultEdit',layoutName:'Layout/LayoutStandard'});Vaultier.CardRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var model=this.get('store').find('Vault',params.vault).then(null,this.handleErrors(transition))
return model;},afterModel:function(vault){Service.Environment.current().set('vault',vault);},serialize:function(vault){return{vault:vault.get('id')}}});Vaultier.CardIndexRoute=Ember.Route.extend({setupController:function(ctrl,model){ctrl.set('content',model);var workspace=this.modelFor('Vault');this.set('workspace',workspace);ctrl.set('workspace',workspace);var vault=this.modelFor('Card');this.set('vault',vault);ctrl.set('vault',vault);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addText('List of cards'))},model:function(params,transition,queryParams){var store=this.get('store');return store.find('Card');},actions:{deleteVault:function(vault){Vaultier.confirmModal(this,'Are you sure?',function(){vault.deleteRecord();vault.save().then(function(){$.notify('Your vault has been successfully deleted.','success');this.transitionTo('Vault.index',this.get('workspace').get('id'));}.bind(this),function(error){card.rollback();$.notify('Oooups! Something went wrong.','error');}.bind(this));}.bind(this));}}});Vaultier.CardIndexController=Ember.ArrayController.extend({workspace:null,vault:null,sortProperties:['name'],sortAscending:true,actions:{createCard:function(){this.set('sortAscending',!this.get('sortAscending'));}}});Vaultier.CardIndexView=Ember.View.extend({templateName:'Card/CardIndex',layoutName:'Layout/LayoutStandard'});Vaultier.CardIndexItemView=Ember.View.extend({templateName:'Card/CardIndexItem'});Vaultier.CardCreateRoute=Ember.Route.extend({workspace:null,actions:{save:function(){var workspace=this.get('workspace');var vault=this.get('vault');var record=this.get('controller.content');record.set('vault',vault.get('id'))
record.save().then(function(){$.notify('Your card has been successfully created.','success');this.transitionTo('Secret.index',workspace.id,vault.id,record.id);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},setupController:function(ctrl,model){ctrl.set('content',model);var workspace=this.modelFor('Vault');this.set('workspace',workspace);ctrl.set('workspace',workspace);var vault=this.modelFor('Card');this.set('vault',vault);ctrl.set('vault',vault);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addText('Create new card'))},model:function(params,queryParams){var store=this.get('store');var record=store.createRecord('Card');return record;},deactivate:function(){var record=this.get('controller.content');if(!record.get('id')){var store=this.get('store');store.deleteRecord(record);}},});Vaultier.CardCreateController=Ember.ObjectController.extend({breadcrumbs:null,workspace:null,vault:null});Vaultier.CardCreateView=Ember.View.extend({templateName:'Card/CardCreate',layoutName:'Layout/LayoutStandard'});Vaultier.CardEditRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{serialize:function(card){return{card:card.id}},model:function(params,transition){var store=this.get('store');var promise=store.find('Card',params.card);promise.then(null,this.handleErrors(transition))
return promise;},setupController:function(ctrl,model){this._super(ctrl,model);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addText('Edit card'))},actions:{save:function(){var record=this.get('controller.content');record.save().then(function(){$.notify('Your changes has been successfully saved.','success');history.go(-1);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}},});Vaultier.CardEditController=Ember.ObjectController.extend({breadcrumbs:null});Vaultier.CardEditView=Ember.View.extend({templateName:'Card/CardEdit',layoutName:'Layout/LayoutStandard'});Vaultier.Router.map(function(){this.resource('AuthRegister',{path:'/auth/register'},function(){this.route('before',{path:'overview'});this.route('keys',{path:'generate-keys'});this.route('creds',{path:'submit-credentials'});this.route('sum',{path:'/registration-done'});})
this.resource('AuthLogin',{path:'/auth/login'},function(){this.route('switch',{path:'/switch-user'});this.route('latest',{path:'/latest-user'});})
this.resource('Workspace',{path:'/manage'},function(){this.route('create',{path:'/action/create-workspace'});this.route('edit',{path:'/action/edit-workspace/:workspace'});this.resource('Vault',{path:'/workspace/:workspace'},function(){this.route('create',{path:'/action/create-vault'});this.route('edit',{path:'/action/edit-vault/:vault'});this.resource('Card',{path:'/vault/:vault'},function(){this.route('create',{path:'/create-card'});this.route('edit',{path:'/action/edit-card/:card'});this.resource('Secret',{path:'/card/:card'},function(){this.route('createSelect',{path:'/action/create-secret/select'});this.route('createSubmit',{path:'/action/create-secret/submit/:type'});this.route('edit',{path:'/action/edit-secret/:secret'});});});})});this.resource('Home',{path:'/home'},function(){})
this.route("Error400",{path:"/errors/error-400"});this.route("Error403",{path:"/errors/error-403"});this.route("Error404",{path:"*path"});});Vaultier.ApplicationRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var auth=Service.Auth.current();var status=auth.reload()
return status;}});Vaultier.IndexRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{redirect:function(){var auth=Service.Auth.current();if(auth.get('isAuthenticated')){return this.transitionTo('Workspace.index');}else{return this.transitionTo('Home.index');}}});Vaultier.SecretCreateSelectRoute=Ember.Route.extend({setupController:function(ctrl,model){ctrl.set('content',{});ctrl.set('submitButtonHidden',true);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addCard().addText('Create new secret'));},renderTemplate:function(){this.render('SecretCreate');this.render('SecretTypeSelect',{outlet:'tab',into:'SecretCreate'});}});Vaultier.SecretCreateSubmitRoute=Ember.Route.extend({model:function(){var store=this.get('store');var record=store.createRecord('Secret');return record;},afterModel:function(secret,transition){secret.set('card',this.modelFor('Secret').get('id'));switch(transition.params.type){case'file':this.template='SecretTypeFile';secret.set('type',secret.types.file);break;case'password':this.template='SecretTypePassword';secret.set('type',secret.types.password);break;default:secret.set('type',secret.types.note);this.template='SecretTypeNote';}},setupController:function(ctrl,model){ctrl.set('content',model);var workspace=this.modelFor('Vault');this.set('workspace',workspace);var vault=this.modelFor('Card');this.set('vault',vault);var card=this.modelFor('Secret');this.set('card',card);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addCard().addText('Create new secret'))},renderTemplate:function(){this.render('SecretCreate');this.render(this.template,{outlet:'tab',into:'SecretCreate'});},deactivate:function(){var record=this.get('controller.content');var store=this.get('store');if(!record.get('id')){store.deleteRecord(record);}},actions:{submit:function(){var record=this.get('controller.content');record.save().then(function(){$.notify('Your secret has been successfully created.','success');this.transitionTo('Secret.index',this.get('workspace').id,this.get('vault').id,this.get('card').id);}.bind(this),function(){$.notify('Oooups! Something went wrong.','error');})}}});Vaultier.SecretCreateController=Ember.Controller.extend({needs:['application']})
Vaultier.SecretCreateView=Ember.View.extend({templateName:'Secret/SecretCreate',layoutName:'Layout/LayoutStandard',TabView:Ember.View.extend({classNameBindings:'isActive:active'.w(),tagName:'li',isActive:function(){var tab=this.get('tab');var path=this.get('parentView.controller.controllers.application.currentPath');var route=path.split('.')[path.split('.').length-1];return tab==route;}.property('parentView.controller.controllers.application.currentPath')})});Vaultier.SecretCreateSelectView=Ember.View.extend({templateName:'Secret/SecretCreateSelect',});Vaultier.SecretTypeFileView=Ember.View.extend({templateName:'Secret/SecretTypeFile'});Vaultier.SecretTypeNoteView=Ember.View.extend({templateName:'Secret/SecretTypeNote'});Vaultier.SecretTypePasswordView=Ember.View.extend({templateName:'Secret/SecretTypePassword'});Vaultier.SecretTypeSelectView=Ember.View.extend({templateName:'Secret/SecretTypeSelect'});Vaultier.SecretRoute=Ember.Route.extend(Utils.ErrorAwareRouteMixin,{model:function(params,transition){var model=this.get('store').find('Card',params.card);model.then(null,this.handleErrors(transition));return model;},afterModel:function(card){Service.Environment.current().set('card',card);},serialize:function(card){return{card:card.get('id')}}});Vaultier.SecretIndexRoute=Ember.Route.extend({setupController:function(ctrl,model){ctrl.set('content',model);var workspace=this.modelFor('Vault');this.set('workspace',workspace);ctrl.set('workspace',workspace);var vault=this.modelFor('Card');this.set('vault',vault);ctrl.set('vault',vault);var card=this.modelFor('Secret');this.set('card',card);ctrl.set('card',card);ctrl.set('breadcrumbs',Vaultier.Breadcrumbs.create({router:this.get('router')}).addHome().addWorkspace().addVault().addCard().addText('Detail'))},model:function(params,queryParams){var store=this.get('store');return store.find('Secret');},actions:{deleteCard:function(card){Vaultier.confirmModal(this,'Are you sure?',function(){card.deleteRecord();card.save().then(function(){$.notify('Your card has been successfully deleted.','success');this.transitionTo('Card.index',this.get('workspace').id,this.get('vault').id);}.bind(this),function(error){card.rollback();alert("An error occured - Please try again");}.bind(this));}.bind(this));}}});Vaultier.SecretIndexController=Ember.ArrayController.extend({itemController:'SecretIndexItem',workspace:null,vault:null,card:null});Vaultier.SecretIndexItemController=Ember.ObjectController.extend({isNote:function(){var secret=this.get('content');return secret.get('type')==secret.types.note;}.property('type'),isPassword:function(){var secret=this.get('content');return secret.get('type')==secret.types.password;}.property('type'),isFile:function(){var secret=this.get('content');return secret.get('type')==secret.types.file;}.property('type')});Vaultier.SecretIndexView=Ember.View.extend({templateName:'Secret/SecretIndex',layoutName:'Layout/LayoutStandard'});Vaultier.SecretIndexItemNoteView=Ember.View.extend({templateName:'Secret/SecretIndexItemNote'});Vaultier.SecretIndexItemPasswordView=Ember.View.extend({templateName:'Secret/SecretIndexItemPassword'});Vaultier.SecretIndexItemFileView=Ember.View.extend({templateName:'Secret/SecretIndexItemFile'});Vaultier.SecretIndexItemControlsView=Ember.View.extend({templateName:'Secret/SecretIndexItemControls'});