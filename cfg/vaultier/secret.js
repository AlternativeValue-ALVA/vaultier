Vaultier.EditorInput=Ember.TextArea.extend({classNames:["vaultier-epic-editor-input"]});
Vaultier.SecretCreateController=Ember.Controller.extend({submitButtonShown:!1,needs:["application"]}),Vaultier.SecretCreateView=Ember.View.extend({templateName:"Secret/SecretCreate",layoutName:"Layout/LayoutStandard",TabView:Ember.View.extend({classNameBindings:"isActive:active".w(),tagName:"li",isActive:function(){var e=this.get("tab"),t=this.get("parentView.controller.controllers.application.currentPath"),r=t.split(".")[t.split(".").length-1];return e==r}.property("parentView.controller.controllers.application.currentPath")})}),Vaultier.SecretCreateSelectRoute=Ember.Route.extend(Vaultier.WorkspaceKeysMixin,{beforeModel:function(){this.checkWorkspaceKeys()},model:function(e,t){var r=this.modelFor("Card");!this.get("auth").checkPermissions(t,function(){return r.get("perms.create")}.bind(this),!0)},setupController:function(e){e.set("content",{}),e.set("controllers.SecretCreate.submitButtonShown",!1),e.get("controllers.SecretCreate").set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addWorkspace().addVault().addCard().addText("Create new secret"))},renderTemplate:function(){this.render("SecretCreate"),this.render("SecretTypeSelect",{outlet:"tab",into:"SecretCreate"})}}),Vaultier.SecretCreateSelectController=Ember.Controller.extend({needs:["SecretCreate"]}),Vaultier.SecretCreateSubmitController=Ember.ObjectController.extend({needs:["SecretCreate"]}),Vaultier.SecretCreateSubmitRoute=Ember.Route.extend(Vaultier.WorkspaceKeysMixin,{beforeModel:function(){this.checkWorkspaceKeys()},model:function(e,t){var r=this.get("store"),a=this.modelFor("Vault"),o=this.modelFor("Workspace"),i=this.modelFor("Card");if(this.get("auth").checkPermissions(t,function(){return this.modelFor("Card").get("perms.create")}.bind(this),!0)){var s=Ember.RSVP.hash({to_workspace:r.find("Role",{to_workspace:o.get("id")}),to_vault:r.find("Role",{to_vault:a.get("id")}),to_card:r.find("Role",{to_card:i.get("id")})}).then(function(e){return[].concat(e.to_workspace.toArray(),e.to_vault.toArray(),e.to_card.toArray())}),n=r.createRecord("Secret");return Ember.RSVP.hash({secret:n,memberships:s})}},afterModel:function(e,t){var r=e.secret;r.set("card",this.modelFor("Card").get("id"));var a=Vaultier.Secret.proto();switch(t.params["Secret.createSubmit"].type.toUpperCase()){case a.types.FILE.text:this.template="SecretTypeFile",r.set("type",a.types.FILE.value);break;case a.types.PASSWORD.text:this.template="SecretTypePassword",r.set("type",a.types.PASSWORD.value);break;default:r.set("type",a.types.NOTE.value),this.template="SecretTypeNote"}},setupController:function(e,t){e.set("content",t.secret),e.set("memberships",t.memberships),e.set("controllers.SecretCreate.submitButtonShown",!0);var r=this.modelFor("Workspace");this.set("workspace",r);var a=this.modelFor("Vault");this.set("vault",a);var o=this.modelFor("Card");this.set("card",o),e.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addWorkspace().addVault().addCard().addText("Create new secret"))},renderTemplate:function(){this.render("SecretCreate"),this.render(this.template,{outlet:"tab",into:"SecretCreate"})},actions:{submit:function(){var e=this.get("controller.content"),t=function(e){throw $.notify("Oooups! Something went wrong.","error"),e};try{var r=e.saveRecord().then(function(){$.notify("Your secret has been successfully created.","success"),this.transitionTo("Secret.index",this.get("card"))}.bind(this)).catch(t);ApplicationLoader.promise(r)}catch(a){ApplicationLoader.hideLoader(),t(a)}}}}),Vaultier.SecretCreateSelectView=Ember.View.extend({templateName:"Secret/SecretCreateSelect"});
Vaultier.SecretEditRoute=Ember.Route.extend(Vaultier.WorkspaceKeysMixin,{beforeModel:function(){this.checkWorkspaceKeys()},serialize:function(e){return{secret:e.id}},model:function(e,t){var r=this.modelFor("Workspace");if(!r.get("hasValidKey"))throw Error("Cannot edit secret without valid workspace key");var o=this.get("store"),i=o.find("Secret",e.secret);return i.then(this.get("auth").checkPermissions(t,function(e){return perms=e.get("perms.update")})),i},setupController:function(e,t){this._super(e,t);var r=this.get("environment");e.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:r}).addHome().addWorkspace().addVault().addCard().addText("Edit secret"))},actions:{save:function(){var e=function(e){throw $.notify("Oooups! Something went wrong.","error"),e};try{var t=this.get("controller.content"),r=t.saveRecord().then(function(){$.notify("Your changes has been successfully saved.","success"),history.go(-1)}.bind(this)).catch(e);ApplicationLoader.promise(r)}catch(o){ApplicationLoader.hideLoader(),e(o)}}}}),Vaultier.SecretEditController=Ember.ObjectController.extend({breadcrumbs:null}),Vaultier.SecretEditView=Ember.View.extend({templateName:"Secret/SecretEdit",layoutName:"Layout/LayoutStandard"});
Vaultier.SecretTypeBaseView=Ember.View.extend({isCreateAction:function(){var e=!(this.get("controller.content.id")>0);return e}.property("controller.content.id")}),Vaultier.SecretTypeFileView=Vaultier.SecretTypeBaseView.extend({templateName:"Secret/SecretTypeFile",didInsertElement:function(){var e=$(this.get("element")),t=e.find(".vlt-secret-type-file"),r=this.get("controller");t.on("change",function(i){var l=FileAPI.getFiles(i);FileAPI.readAsBinaryString(l[0],function(i){if("load"==i.type){var a=i.result,n=i.result.length;n>25e3?(t.closest(".form-group").addClass("has-error"),$.notify("Maximum filesize 25K exceeded!","error")):(t.closest(".form-group").removeClass("has-error"),r.set("content.blob.filedata",a),r.set("content.blob.filename",l[0].name),r.set("content.blob.filesize",l[0].size),r.set("content.blob.filetype",l[0].type),$(e).find(".vlt-filename").attr("value",l[0].name))}})})}}),Vaultier.SecretTypeNoteView=Vaultier.SecretTypeBaseView.extend({templateName:"Secret/SecretTypeNote"}),Vaultier.SecretTypePasswordView=Vaultier.SecretTypeBaseView.extend({templateName:"Secret/SecretTypePassword"}),Vaultier.SecretTypeSelectView=Vaultier.SecretTypeBaseView.extend({templateName:"Secret/SecretTypeSelect"});
Vaultier.SecretIndexRoute=Ember.Route.extend(Vaultier.WorkspaceKeysMixin,{beforeModel:function(){this.checkWorkspaceKeys()},model:function(){var e=this.modelFor("Vault"),t=this.modelFor("Workspace"),r=this.modelFor("Card"),o=this.get("store"),a=o.find("Secret",{card:r.get("id")}),n=Ember.RSVP.hash({to_workspace:o.find("Role",{to_workspace:t.get("id")}),to_vault:o.find("Role",{to_vault:e.get("id")}),to_card:o.find("Role",{to_card:r.get("id")})}).then(function(e){return[].concat(e.to_workspace.toArray(),e.to_vault.toArray(),e.to_card.toArray())});return Ember.RSVP.hash({secrets:a,memberships:n})},setupController:function(e,t){e.set("content",t.secrets),e.set("memberships",t.memberships);var r=this.modelFor("Workspace");this.set("workspace",r),e.set("workspace",r);var o=this.modelFor("Vault");this.set("vault",o),e.set("vault",o);var a=this.modelFor("Card");this.set("card",a),e.set("card",a),e.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addWorkspace().addVault().addCard())},actions:{downloadBlob:function(e){ApplicationLoader.showLoader(),e.loadBlob().finally(function(){ApplicationLoader.hideLoader()}).then(function(){for(var t=e.get("blob.filedata"),r=e.get("blob.filetype"),o=e.get("blob.filename"),a=new Uint8Array(t.length),n=0;n<t.length;n++)a[n]=255&t.charCodeAt(n);var i=new Blob([a.buffer],{type:r});saveAs(i,o)}.bind(this))},deleteSecret:function(e){Vaultier.confirmModal(this,"Are you sure?",function(){this.get("controller.content").removeObject(e);var t=e.deleteRecord().then(function(){$.notify("Your secret has been successfully deleted.","success")}.bind(this),function(){e.rollback(),$.notify("Oooups! Something went wrong.","error")}.bind(this));ApplicationLoader.promise(t)}.bind(this))}}}),Vaultier.SecretIndexController=Ember.ArrayController.extend({itemController:"SecretIndexItem",workspace:null,vault:null,card:null}),Vaultier.SecretIndexItemController=Ember.ObjectController.extend({}),Vaultier.SecretIndexView=Ember.View.extend({templateName:"Secret/SecretIndex",layoutName:"Layout/LayoutStandard"}),Vaultier.SecretIndexItemNoteView=Ember.View.extend({templateName:"Secret/SecretIndexItemNote"}),Vaultier.SecretIndexItemPasswordView=Ember.View.extend({templateName:"Secret/SecretIndexItemPassword"}),Vaultier.SecretIndexItemFileView=Ember.View.extend({templateName:"Secret/SecretIndexItemFile"}),Vaultier.SecretIndexItemControlsView=Ember.View.extend({templateName:"Secret/SecretIndexItemControls"});
Vaultier.SecretCardNodeView=Ember.Tree.TreeNodeView.extend({templateName:"Secret/SecretMoveCardNode",Radio:Ember.View.extend({tagName:"input",type:"radio",attributeBindings:["type","name","value"],click:function(){this.get("controller").send("selected",this.$().val())}}),loadData:function(){return[]}}),Vaultier.SecretVaultNodeView=Ember.Tree.TreeNodeView.extend({templateName:"Secret/SecretMoveVaultNode",getSubNodeViewClass:function(){return Vaultier.SecretCardNodeView},loadData:function(){var e=this.get("controller.store"),t=this.get("content.id"),r=e.find("Card",{vault:t}).then(function(e){return e.forEach(function(e){e.set("branch",!0)}),e});return r}}),Vaultier.SecretMoveRoute=Ember.Route.extend(Vaultier.WorkspaceKeysMixin,{beforeModel:function(){this.checkWorkspaceKeys()},serialize:function(e){return{secret:e.id}},model:function(e,t){var r=this.modelFor("Workspace"),n=this.get("store"),o=n.find("Secret",e.secret);o.then(this.get("auth").checkPermissions(t,function(e){return perms=e.get("perms.update")}));var i=n.find("Vault",{workspace:r.get("id")}).then(function(e){return e.forEach(function(e){e.set("branch",!0)}),e});return Ember.RSVP.hash({secret:o,vaults:i})},setupController:function(e,t){e.set("content",t.secret),e.set("treeNodes",t.vaults),e.set("breadcrumbs",Vaultier.Breadcrumbs.create({router:this.get("router"),environment:this.get("environment")}).addHome().addWorkspace().addVault().addCard().addText("Move secret"))},actions:{save:function(){var e=this.get("controller.content");e.set("card",this.get("controller.selected")),e.saveRecord().then(function(){$.notify("Your secret has been successfully moved.","success"),history.go(-1)}.bind(this),function(){$.notify("Oooups! Something went wrong.","error")})}}}),Vaultier.SecretMoveController=Ember.ObjectController.extend({moveDisabled:function(){return!this.get("selected")}.property("selected"),selected:!1,breadcrumbs:null,actions:{selected:function(e){this.set("selected",e)}}}),Vaultier.SecretMoveView=Ember.View.extend({templateName:"Secret/SecretMove",layoutName:"Layout/LayoutStandard",Tree:Ember.Tree.TreeView.extend({itemViewClass:Vaultier.SecretVaultNodeView})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVkaXRvcklucHV0LmpzIiwiU2VjcmV0Q3JlYXRlLmpzIiwiU2VjcmV0RWRpdC5qcyIsIlNlY3JldFR5cGUuanMiLCJTZWNyZXRJbmRleC5qcyIsIlNlY3JldE1vdmUuanMiXSwibmFtZXMiOlsiVmF1bHRpZXIiLCJFZGl0b3JJbnB1dCIsIkVtYmVyIiwiVGV4dEFyZWEiLCJleHRlbmQiLCJjbGFzc05hbWVzIiwiU2VjcmV0Q3JlYXRlQ29udHJvbGxlciIsIkNvbnRyb2xsZXIiLCJzdWJtaXRCdXR0b25TaG93biIsIm5lZWRzIiwiU2VjcmV0Q3JlYXRlVmlldyIsIlZpZXciLCJ0ZW1wbGF0ZU5hbWUiLCJsYXlvdXROYW1lIiwiVGFiVmlldyIsImNsYXNzTmFtZUJpbmRpbmdzIiwidyIsInRhZ05hbWUiLCJpc0FjdGl2ZSIsInRhYiIsInRoaXMiLCJnZXQiLCJwYXRoIiwicm91dGUiLCJzcGxpdCIsImxlbmd0aCIsInByb3BlcnR5IiwiU2VjcmV0Q3JlYXRlU2VsZWN0Um91dGUiLCJSb3V0ZSIsIldvcmtzcGFjZUtleXNNaXhpbiIsImJlZm9yZU1vZGVsIiwiY2hlY2tXb3Jrc3BhY2VLZXlzIiwibW9kZWwiLCJwYXJhbXMiLCJ0cmFuc2l0aW9uIiwiY2FyZCIsIm1vZGVsRm9yIiwiY2hlY2tQZXJtaXNzaW9ucyIsImJpbmQiLCJzZXR1cENvbnRyb2xsZXIiLCJjdHJsIiwic2V0IiwiQnJlYWRjcnVtYnMiLCJjcmVhdGUiLCJyb3V0ZXIiLCJlbnZpcm9ubWVudCIsImFkZEhvbWUiLCJhZGRXb3Jrc3BhY2UiLCJhZGRWYXVsdCIsImFkZENhcmQiLCJhZGRUZXh0IiwicmVuZGVyVGVtcGxhdGUiLCJyZW5kZXIiLCJvdXRsZXQiLCJpbnRvIiwiU2VjcmV0Q3JlYXRlU2VsZWN0Q29udHJvbGxlciIsIlNlY3JldENyZWF0ZVN1Ym1pdENvbnRyb2xsZXIiLCJPYmplY3RDb250cm9sbGVyIiwiU2VjcmV0Q3JlYXRlU3VibWl0Um91dGUiLCJzdG9yZSIsInZhdWx0Iiwid29ya3NwYWNlIiwibWVtYmVyc2hpcHMiLCJSU1ZQIiwiaGFzaCIsInRvX3dvcmtzcGFjZSIsImZpbmQiLCJ0b192YXVsdCIsInRvX2NhcmQiLCJ0aGVuIiwiY29uY2F0IiwidG9BcnJheSIsInNlY3JldCIsImNyZWF0ZVJlY29yZCIsImFmdGVyTW9kZWwiLCJTZWNyZXRDbGFzcyIsIlNlY3JldCIsInByb3RvIiwidHlwZSIsInRvVXBwZXJDYXNlIiwidHlwZXMiLCJ0ZXh0IiwidGVtcGxhdGUiLCJ2YWx1ZSIsImFjdGlvbnMiLCJzdWJtaXQiLCJyZWNvcmQiLCJub3RpZnlFcnJvciIsImVycm9yIiwiJCIsIm5vdGlmeSIsInByb21pc2UiLCJzYXZlUmVjb3JkIiwidHJhbnNpdGlvblRvIiwiY2F0Y2giLCJBcHBsaWNhdGlvbkxvYWRlciIsImUiLCJoaWRlTG9hZGVyIiwiU2VjcmV0Q3JlYXRlU2VsZWN0VmlldyIsIlNlY3JldEVkaXRSb3V0ZSIsInNlcmlhbGl6ZSIsImlkIiwiRXJyb3IiLCJwZXJtcyIsIl9zdXBlciIsInNhdmUiLCJoaXN0b3J5IiwiZ28iLCJTZWNyZXRFZGl0Q29udHJvbGxlciIsImJyZWFkY3J1bWJzIiwiU2VjcmV0RWRpdFZpZXciLCJTZWNyZXRUeXBlQmFzZVZpZXciLCJpc0NyZWF0ZUFjdGlvbiIsInIiLCJTZWNyZXRUeXBlRmlsZVZpZXciLCJkaWRJbnNlcnRFbGVtZW50IiwiZWwiLCJpbnB1dCIsImNvbnRyb2xsZXIiLCJvbiIsImZpbGVzIiwiRmlsZUFQSSIsImdldEZpbGVzIiwicmVhZEFzQmluYXJ5U3RyaW5nIiwiZXZ0IiwiZGF0YSIsInJlc3VsdCIsInNpemUiLCJjbG9zZXN0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsIm5hbWUiLCJhdHRyIiwiU2VjcmV0VHlwZU5vdGVWaWV3IiwiU2VjcmV0VHlwZVBhc3N3b3JkVmlldyIsIlNlY3JldFR5cGVTZWxlY3RWaWV3IiwiU2VjcmV0SW5kZXhSb3V0ZSIsInNlY3JldHMiLCJkb3dubG9hZEJsb2IiLCJzaG93TG9hZGVyIiwibG9hZEJsb2IiLCJmaW5hbGx5IiwiYnl0ZUFycmF5IiwiVWludDhBcnJheSIsImkiLCJjaGFyQ29kZUF0IiwiYmxvYiIsIkJsb2IiLCJidWZmZXIiLCJzYXZlQXMiLCJkZWxldGVTZWNyZXQiLCJjb25maXJtTW9kYWwiLCJyZW1vdmVPYmplY3QiLCJkZWxldGVSZWNvcmQiLCJyb2xsYmFjayIsIlNlY3JldEluZGV4Q29udHJvbGxlciIsIkFycmF5Q29udHJvbGxlciIsIml0ZW1Db250cm9sbGVyIiwiU2VjcmV0SW5kZXhJdGVtQ29udHJvbGxlciIsIlNlY3JldEluZGV4VmlldyIsIlNlY3JldEluZGV4SXRlbU5vdGVWaWV3IiwiU2VjcmV0SW5kZXhJdGVtUGFzc3dvcmRWaWV3IiwiU2VjcmV0SW5kZXhJdGVtRmlsZVZpZXciLCJTZWNyZXRJbmRleEl0ZW1Db250cm9sc1ZpZXciLCJTZWNyZXRDYXJkTm9kZVZpZXciLCJUcmVlIiwiVHJlZU5vZGVWaWV3IiwiUmFkaW8iLCJhdHRyaWJ1dGVCaW5kaW5ncyIsImNsaWNrIiwic2VuZCIsInZhbCIsImxvYWREYXRhIiwiU2VjcmV0VmF1bHROb2RlVmlldyIsImdldFN1Yk5vZGVWaWV3Q2xhc3MiLCJub2RlcyIsImZvckVhY2giLCJpdGVtIiwiU2VjcmV0TW92ZVJvdXRlIiwidmF1bHRzIiwiU2VjcmV0TW92ZUNvbnRyb2xsZXIiLCJtb3ZlRGlzYWJsZWQiLCJzZWxlY3RlZCIsIlNlY3JldE1vdmVWaWV3IiwiVHJlZVZpZXciLCJpdGVtVmlld0NsYXNzIl0sIm1hcHBpbmdzIjoiQUFBQUEsU0FBU0MsWUFBY0MsTUFBTUMsU0FBU0MsUUFDbENDLFlBQWE7QUNEakJMLFNBQVNNLHVCQUF5QkosTUFBTUssV0FBV0gsUUFDL0NJLG1CQUFtQixFQUNuQkMsT0FBUSxpQkFHWlQsU0FBU1UsaUJBQW1CUixNQUFNUyxLQUFLUCxRQUNuQ1EsYUFBYyxzQkFDZEMsV0FBWSx3QkFFWkMsUUFBU1osTUFBTVMsS0FBS1AsUUFDaEJXLGtCQUFtQixrQkFBa0JDLElB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Q1YsT0FBUWpLLEtBQUtDLElBQUksYUFDbkJLLFNBQVMsWUFDWDRKLFVBQVUsRUFDVnpFLFlBQWEsS0FDYnpCLFNBQ0lrRyxTQUFVLFNBQVVYLEdBQ2hCdkosS0FBS3FCLElBQUksV0FBWWtJLE9BS2pDM0ssU0FBU3VMLGVBQWlCckwsTUFBTVMsS0FBS1AsUUFDakNRLGFBQWMsb0JBQ2RDLFdBQVksd0JBQ1p3SixLQUFNbkssTUFBTW1LLEtBQUttQixTQUFTcEwsUUFDdEJxTCxjQUFlekwsU0FBUzZLIiwiZmlsZSI6InNlY3JldC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlZhdWx0aWVyLkVkaXRvcklucHV0ID0gRW1iZXIuVGV4dEFyZWEuZXh0ZW5kKHtcbiAgICBjbGFzc05hbWVzOiBbJ3ZhdWx0aWVyLWVwaWMtZWRpdG9yLWlucHV0J11cblxufSk7XG4iLCJWYXVsdGllci5TZWNyZXRDcmVhdGVDb250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxlci5leHRlbmQoe1xyXG4gICAgc3VibWl0QnV0dG9uU2hvd246IGZhbHNlLFxyXG4gICAgbmVlZHM6IFsnYXBwbGljYXRpb24nXVxyXG59KTtcclxuXHJcblZhdWx0aWVyLlNlY3JldENyZWF0ZVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0Q3JlYXRlJyxcclxuICAgIGxheW91dE5hbWU6ICdMYXlvdXQvTGF5b3V0U3RhbmRhcmQnLFxyXG5cclxuICAgIFRhYlZpZXc6IEVtYmVyLlZpZXcuZXh0ZW5kKHtcclxuICAgICAgICBjbGFzc05hbWVCaW5kaW5nczogJ2lzQWN0aXZlOmFjdGl2ZScudygpLFxyXG4gICAgICAgIHRhZ05hbWU6ICdsaScsXHJcbiAgICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHRhYiA9IHRoaXMuZ2V0KCd0YWInKTtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLmdldCgncGFyZW50Vmlldy5jb250cm9sbGVyLmNvbnRyb2xsZXJzLmFwcGxpY2F0aW9uLmN1cnJlbnRQYXRoJyk7XHJcbiAgICAgICAgICAgIHZhciByb3V0ZSA9IHBhdGguc3BsaXQoJy4nKVtwYXRoLnNwbGl0KCcuJykubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIHJldHVybiB0YWIgPT0gcm91dGU7XHJcbiAgICAgICAgfS5wcm9wZXJ0eSgncGFyZW50Vmlldy5jb250cm9sbGVyLmNvbnRyb2xsZXJzLmFwcGxpY2F0aW9uLmN1cnJlbnRQYXRoJylcclxuICAgIH0pXHJcblxyXG59KTtcclxuXHJcblZhdWx0aWVyLlNlY3JldENyZWF0ZVNlbGVjdFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKFxyXG4gICAgVmF1bHRpZXIuV29ya3NwYWNlS2V5c01peGluLFxyXG4gICAge1xyXG4gICAgICAgIGJlZm9yZU1vZGVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tXb3Jrc3BhY2VLZXlzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbW9kZWw6IGZ1bmN0aW9uIChwYXJhbXMsIHRyYW5zaXRpb24pIHtcclxuICAgICAgICAgICAgdmFyIGNhcmQgPSB0aGlzLm1vZGVsRm9yKCdDYXJkJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBjaGVjayBwZXJtaXNzaW9uc1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0KCdhdXRoJykuY2hlY2tQZXJtaXNzaW9ucyh0cmFuc2l0aW9uLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZC5nZXQoJ3Blcm1zLmNyZWF0ZScpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHRydWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0aW9uIChjdHJsLCBtb2RlbCkge1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnY29udGVudCcsIHt9KTtcclxuXHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdjb250cm9sbGVycy5TZWNyZXRDcmVhdGUuc3VibWl0QnV0dG9uU2hvd24nLCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgYnJlYWRjcnVtYnNcclxuICAgICAgICAgICAgY3RybC5nZXQoJ2NvbnRyb2xsZXJzLlNlY3JldENyZWF0ZScpLnNldCgnYnJlYWRjcnVtYnMnLFxyXG4gICAgICAgICAgICAgICAgVmF1bHRpZXIuQnJlYWRjcnVtYnMuY3JlYXRlKHtyb3V0ZXI6IHRoaXMuZ2V0KCdyb3V0ZXInKSwgZW52aXJvbm1lbnQ6IHRoaXMuZ2V0KCdlbnZpcm9ubWVudCcpfSlcclxuICAgICAgICAgICAgICAgICAgICAuYWRkSG9tZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFdvcmtzcGFjZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2FyZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFRleHQoJ0NyZWF0ZSBuZXcgc2VjcmV0JylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcignU2VjcmV0Q3JlYXRlJyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCdTZWNyZXRUeXBlU2VsZWN0Jywge291dGxldDogJ3RhYicsIGludG86ICdTZWNyZXRDcmVhdGUnfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5WYXVsdGllci5TZWNyZXRDcmVhdGVTZWxlY3RDb250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxlci5leHRlbmQoe1xyXG4gICAgbmVlZHM6IFsnU2VjcmV0Q3JlYXRlJ11cclxufSk7XHJcblxyXG5WYXVsdGllci5TZWNyZXRDcmVhdGVTdWJtaXRDb250cm9sbGVyID0gRW1iZXIuT2JqZWN0Q29udHJvbGxlci5leHRlbmQoe1xyXG4gICAgbmVlZHM6IFsnU2VjcmV0Q3JlYXRlJ11cclxufSk7XHJcblxyXG5cclxuVmF1bHRpZXIuU2VjcmV0Q3JlYXRlU3VibWl0Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoXHJcbiAgICBWYXVsdGllci5Xb3Jrc3BhY2VLZXlzTWl4aW4sXHJcbiAgICB7XHJcbiAgICAgICAgYmVmb3JlTW9kZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1dvcmtzcGFjZUtleXMoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtb2RlbDogZnVuY3Rpb24gKHBhcmFtcywgdHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgc3RvcmUgPSB0aGlzLmdldCgnc3RvcmUnKTtcclxuICAgICAgICAgICAgdmFyIHZhdWx0ID0gdGhpcy5tb2RlbEZvcignVmF1bHQnKTtcclxuICAgICAgICAgICAgdmFyIHdvcmtzcGFjZSA9IHRoaXMubW9kZWxGb3IoJ1dvcmtzcGFjZScpO1xyXG4gICAgICAgICAgICB2YXIgY2FyZCA9IHRoaXMubW9kZWxGb3IoJ0NhcmQnKTtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyBjaGVjayBwZXJtaXNzaW9uc1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0KCdhdXRoJykuY2hlY2tQZXJtaXNzaW9ucyh0cmFuc2l0aW9uLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbEZvcignQ2FyZCcpLmdldCgncGVybXMuY3JlYXRlJyk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdHJ1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gbG9hZCBtZW1iZXJzaGlwc1xyXG4gICAgICAgICAgICB2YXIgbWVtYmVyc2hpcHMgPSBFbWJlci5SU1ZQXHJcbiAgICAgICAgICAgICAgICAuaGFzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9fd29ya3NwYWNlOiBzdG9yZS5maW5kKCdSb2xlJywge3RvX3dvcmtzcGFjZTogd29ya3NwYWNlLmdldCgnaWQnKSB9KSxcclxuICAgICAgICAgICAgICAgICAgICB0b192YXVsdDogc3RvcmUuZmluZCgnUm9sZScsIHt0b192YXVsdDogdmF1bHQuZ2V0KCdpZCcpfSksXHJcbiAgICAgICAgICAgICAgICAgICAgdG9fY2FyZDogc3RvcmUuZmluZCgnUm9sZScsIHt0b19jYXJkOiBjYXJkLmdldCgnaWQnKX0pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG1lbWJlcnNoaXBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChtZW1iZXJzaGlwcy50b193b3Jrc3BhY2UudG9BcnJheSgpLCBtZW1iZXJzaGlwcy50b192YXVsdC50b0FycmF5KCksIG1lbWJlcnNoaXBzLnRvX2NhcmQudG9BcnJheSgpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0cmlldmUgbW9kZWxcclxuICAgICAgICAgICAgdmFyIHNlY3JldCA9IHN0b3JlLmNyZWF0ZVJlY29yZCgnU2VjcmV0Jyk7XHJcblxyXG4gICAgICAgICAgICAvLyByZXR1cm4gcHJvbWlzZSBmb3IgYWxsIHJlcXVlc3RzXHJcbiAgICAgICAgICAgIHJldHVybiBFbWJlci5SU1ZQLmhhc2goe1xyXG4gICAgICAgICAgICAgICAgc2VjcmV0OiBzZWNyZXQsXHJcbiAgICAgICAgICAgICAgICBtZW1iZXJzaGlwczogbWVtYmVyc2hpcHNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWZ0ZXJNb2RlbDogZnVuY3Rpb24gKG1vZGVsLCB0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWNyZXQgPSBtb2RlbC5zZWNyZXQ7XHJcbiAgICAgICAgICAgIHNlY3JldC5zZXQoJ2NhcmQnLCB0aGlzLm1vZGVsRm9yKCdDYXJkJykuZ2V0KCdpZCcpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBTZWNyZXRDbGFzcyA9IFZhdWx0aWVyLlNlY3JldC5wcm90bygpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRyYW5zaXRpb24ucGFyYW1zWydTZWNyZXQuY3JlYXRlU3VibWl0J10udHlwZS50b1VwcGVyQ2FzZSgpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBTZWNyZXRDbGFzcy50eXBlc1snRklMRSddLnRleHQgOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGUgPSAnU2VjcmV0VHlwZUZpbGUnO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlY3JldC5zZXQoJ3R5cGUnLCBTZWNyZXRDbGFzcy50eXBlc1snRklMRSddLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIFNlY3JldENsYXNzLnR5cGVzWydQQVNTV09SRCddLnRleHQgOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGUgPSAnU2VjcmV0VHlwZVBhc3N3b3JkJztcclxuICAgICAgICAgICAgICAgICAgICBzZWNyZXQuc2V0KCd0eXBlJywgU2VjcmV0Q2xhc3MudHlwZXNbJ1BBU1NXT1JEJ10udmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgc2VjcmV0LnNldCgndHlwZScsIFNlY3JldENsYXNzLnR5cGVzWydOT1RFJ10udmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGUgPSAnU2VjcmV0VHlwZU5vdGUnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbiAoY3RybCwgbW9kZWwpIHtcclxuICAgICAgICAgICAgY3RybC5zZXQoJ2NvbnRlbnQnLCBtb2RlbC5zZWNyZXQpO1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnbWVtYmVyc2hpcHMnLCBtb2RlbC5tZW1iZXJzaGlwcyk7XHJcblxyXG4gICAgICAgICAgICBjdHJsLnNldCgnY29udHJvbGxlcnMuU2VjcmV0Q3JlYXRlLnN1Ym1pdEJ1dHRvblNob3duJywgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyByZXRyaWV2ZSB3b3Jrc3BhY2VcclxuICAgICAgICAgICAgdmFyIHdvcmtzcGFjZSA9IHRoaXMubW9kZWxGb3IoJ1dvcmtzcGFjZScpO1xyXG4gICAgICAgICAgICB0aGlzLnNldCgnd29ya3NwYWNlJywgd29ya3NwYWNlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJldHJpZXZlIHZhdWx0XHJcbiAgICAgICAgICAgIHZhciB2YXVsdCA9IHRoaXMubW9kZWxGb3IoJ1ZhdWx0Jyk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KCd2YXVsdCcsIHZhdWx0KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJldHJpZXZlIHZhdWx0XHJcbiAgICAgICAgICAgIHZhciBjYXJkID0gdGhpcy5tb2RlbEZvcignQ2FyZCcpO1xyXG4gICAgICAgICAgICB0aGlzLnNldCgnY2FyZCcsIGNhcmQpO1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0IGJyZWFkY3J1bWJzXHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdicmVhZGNydW1icycsXHJcbiAgICAgICAgICAgICAgICBWYXVsdGllci5CcmVhZGNydW1icy5jcmVhdGUoe3JvdXRlcjogdGhpcy5nZXQoJ3JvdXRlcicpLCBlbnZpcm9ubWVudDogdGhpcy5nZXQoJ2Vudmlyb25tZW50Jyl9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRIb21lKClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkV29ya3NwYWNlKClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkVmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDYXJkKClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkVGV4dCgnQ3JlYXRlIG5ldyBzZWNyZXQnKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCdTZWNyZXRDcmVhdGUnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIodGhpcy50ZW1wbGF0ZSwge291dGxldDogJ3RhYicsIGludG86ICdTZWNyZXRDcmVhdGUnfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWN0aW9uczoge1xyXG4gICAgICAgICAgICBzdWJtaXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0aGlzLmdldCgnY29udHJvbGxlci5jb250ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm90aWZ5RXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHJlY29yZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2F2ZVJlY29yZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5ub3RpZnkoJ1lvdXIgc2VjcmV0IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBjcmVhdGVkLicsICdzdWNjZXNzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25UbygnU2VjcmV0LmluZGV4JywgdGhpcy5nZXQoJ2NhcmQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKG5vdGlmeUVycm9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Mb2FkZXIucHJvbWlzZShwcm9taXNlKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZ5RXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG5WYXVsdGllci5TZWNyZXRDcmVhdGVTZWxlY3RWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldENyZWF0ZVNlbGVjdCdcclxufSk7XHJcbiIsIlZhdWx0aWVyLlNlY3JldEVkaXRSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChcbiAgICBWYXVsdGllci5Xb3Jrc3BhY2VLZXlzTWl4aW4sXG4gICAge1xuICAgICAgICBiZWZvcmVNb2RlbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jaGVja1dvcmtzcGFjZUtleXMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uIChzZWNyZXQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc2VjcmV0OiBzZWNyZXQuaWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW9kZWw6IGZ1bmN0aW9uIChwYXJhbXMsIHRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIHdvcmtzcGFjZSBrZXlzXG4gICAgICAgICAgICB2YXIgd29ya3NwYWNlID0gdGhpcy5tb2RlbEZvcignV29ya3NwYWNlJyk7XG4gICAgICAgICAgICBpZiAoIXdvcmtzcGFjZS5nZXQoJ2hhc1ZhbGlkS2V5JykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignQ2Fubm90IGVkaXQgc2VjcmV0IHdpdGhvdXQgdmFsaWQgd29ya3NwYWNlIGtleScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3RvcmUgPSB0aGlzLmdldCgnc3RvcmUnKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gc3RvcmUuZmluZCgnU2VjcmV0JywgcGFyYW1zLnNlY3JldCk7XG4gICAgICAgICAgICBwcm9taXNlXG4gICAgICAgICAgICAgICAgLnRoZW4odGhpcy5nZXQoJ2F1dGgnKS5jaGVja1Blcm1pc3Npb25zKHRyYW5zaXRpb24sIGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICBwZXJtcyA9IG1vZGVsLmdldCgncGVybXMudXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwZXJtcztcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldHVwQ29udHJvbGxlcjogZnVuY3Rpb24gKGN0cmwsIG1vZGVsKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXBlcihjdHJsLCBtb2RlbCk7XG5cbiAgICAgICAgICAgIC8vIHNldCBicmVhZGNydW1ic1xuICAgICAgICAgICAgdmFyIGVudmlyb25tZW50ID0gdGhpcy5nZXQoJ2Vudmlyb25tZW50Jyk7XG5cbiAgICAgICAgICAgIGN0cmwuc2V0KCdicmVhZGNydW1icycsXG4gICAgICAgICAgICAgICAgVmF1bHRpZXIuQnJlYWRjcnVtYnMuY3JlYXRlKHtyb3V0ZXI6IHRoaXMuZ2V0KCdyb3V0ZXInKSwgZW52aXJvbm1lbnQ6IGVudmlyb25tZW50fSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZEhvbWUoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkV29ya3NwYWNlKClcbiAgICAgICAgICAgICAgICAgICAgLmFkZFZhdWx0KClcbiAgICAgICAgICAgICAgICAgICAgLmFkZENhcmQoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkVGV4dCgnRWRpdCBzZWNyZXQnKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhY3Rpb25zOiB7XG4gICAgICAgICAgICBzYXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vdGlmeUVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICQubm90aWZ5KCdPb291cHMhIFNvbWV0aGluZyB3ZW50IHdyb25nLicsICdlcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRoaXMuZ2V0KCdjb250cm9sbGVyLmNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSByZWNvcmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zYXZlUmVjb3JkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnWW91ciBjaGFuZ2VzIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBzYXZlZC4nLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnkuZ28oLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKG5vdGlmeUVycm9yKTtcblxuICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5wcm9taXNlKHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25Mb2FkZXIuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICBub3RpZnlFcnJvcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuVmF1bHRpZXIuU2VjcmV0RWRpdENvbnRyb2xsZXIgPSBFbWJlci5PYmplY3RDb250cm9sbGVyLmV4dGVuZCh7XG4gICAgYnJlYWRjcnVtYnM6IG51bGxcbn0pO1xuXG5WYXVsdGllci5TZWNyZXRFZGl0VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHtcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0RWRpdCcsXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCdcbn0pO1xuIiwiVmF1bHRpZXIuU2VjcmV0VHlwZUJhc2VWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xyXG5cclxuICAgIGlzQ3JlYXRlQWN0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgciA9ICAhKHRoaXMuZ2V0KCdjb250cm9sbGVyLmNvbnRlbnQuaWQnKSA+IDApO1xyXG4gICAgICAgIHJldHVybiByO1xyXG4gICAgfS5wcm9wZXJ0eSgnY29udHJvbGxlci5jb250ZW50LmlkJylcclxuXHJcbn0pO1xyXG5cclxuVmF1bHRpZXIuU2VjcmV0VHlwZUZpbGVWaWV3ID0gVmF1bHRpZXIuU2VjcmV0VHlwZUJhc2VWaWV3LmV4dGVuZCAoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldFR5cGVGaWxlJyxcclxuXHJcbiAgICBkaWRJbnNlcnRFbGVtZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVsID0gJCh0aGlzLmdldCgnZWxlbWVudCcpKTtcclxuICAgICAgICB2YXIgaW5wdXQgPSBlbC5maW5kKCcudmx0LXNlY3JldC10eXBlLWZpbGUnKTtcclxuICAgICAgICB2YXIgY29udHJvbGxlciA9IHRoaXMuZ2V0KCdjb250cm9sbGVyJyk7XHJcblxyXG4gICAgICAgIGlucHV0Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGZpbGVzID0gRmlsZUFQSS5nZXRGaWxlcyhlKTtcclxuICAgICAgICAgICAgRmlsZUFQSS5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZXNbMF0sIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChldnQudHlwZSA9PSAnbG9hZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGV2dC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBldnQucmVzdWx0Lmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpemUgPiAyNTAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpLmFkZENsYXNzKCdoYXMtZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5ub3RpZnkoJ01heGltdW0gZmlsZXNpemUgMjVLIGV4Y2VlZGVkIScsICdlcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKS5yZW1vdmVDbGFzcygnaGFzLWVycm9yJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2V0KCdjb250ZW50LmJsb2IuZmlsZWRhdGEnLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5zZXQoJ2NvbnRlbnQuYmxvYi5maWxlbmFtZScsIGZpbGVzWzBdLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNldCgnY29udGVudC5ibG9iLmZpbGVzaXplJywgZmlsZXNbMF0uc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2V0KCdjb250ZW50LmJsb2IuZmlsZXR5cGUnLCBmaWxlc1swXS50eXBlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoZWwpLmZpbmQoJy52bHQtZmlsZW5hbWUnKS5hdHRyKCd2YWx1ZScsIGZpbGVzWzBdLm5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG59KTtcclxuXHJcblZhdWx0aWVyLlNlY3JldFR5cGVOb3RlVmlldyA9VmF1bHRpZXIuU2VjcmV0VHlwZUJhc2VWaWV3LmV4dGVuZCAoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldFR5cGVOb3RlJ1xyXG59KTtcclxuXHJcblZhdWx0aWVyLlNlY3JldFR5cGVQYXNzd29yZFZpZXcgPSBWYXVsdGllci5TZWNyZXRUeXBlQmFzZVZpZXcuZXh0ZW5kICh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0VHlwZVBhc3N3b3JkJ1xyXG59KTtcclxuXHJcblZhdWx0aWVyLlNlY3JldFR5cGVTZWxlY3RWaWV3ID0gVmF1bHRpZXIuU2VjcmV0VHlwZUJhc2VWaWV3LmV4dGVuZCAoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldFR5cGVTZWxlY3QnXHJcbn0pOyIsIlZhdWx0aWVyLlNlY3JldEluZGV4Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoXHJcbiAgICBWYXVsdGllci5Xb3Jrc3BhY2VLZXlzTWl4aW4sXHJcbiAgICB7XHJcbiAgICAgICAgYmVmb3JlTW9kZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1dvcmtzcGFjZUtleXMoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtb2RlbDogZnVuY3Rpb24gKHBhcmFtcywgcXVlcnlQYXJhbXMpIHtcclxuICAgICAgICAgICAgdmFyIHZhdWx0ID0gdGhpcy5tb2RlbEZvcignVmF1bHQnKTtcclxuICAgICAgICAgICAgdmFyIHdvcmtzcGFjZSA9IHRoaXMubW9kZWxGb3IoJ1dvcmtzcGFjZScpO1xyXG4gICAgICAgICAgICB2YXIgY2FyZCA9IHRoaXMubW9kZWxGb3IoJ0NhcmQnKTtcclxuICAgICAgICAgICAgdmFyIHN0b3JlID0gdGhpcy5nZXQoJ3N0b3JlJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBsb2FkIHNlY3JldHNcclxuICAgICAgICAgICAgdmFyIHNlY3JldHMgPSBzdG9yZS5maW5kKCdTZWNyZXQnLCB7Y2FyZDogY2FyZC5nZXQoJ2lkJyl9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIGxvYWQgbWVtYmVyc2hpcHNcclxuICAgICAgICAgICAgdmFyIG1lbWJlcnNoaXBzID0gRW1iZXIuUlNWUFxyXG4gICAgICAgICAgICAgICAgLmhhc2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRvX3dvcmtzcGFjZTogc3RvcmUuZmluZCgnUm9sZScsIHt0b193b3Jrc3BhY2U6IHdvcmtzcGFjZS5nZXQoJ2lkJykgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgdG9fdmF1bHQ6IHN0b3JlLmZpbmQoJ1JvbGUnLCB7dG9fdmF1bHQ6IHZhdWx0LmdldCgnaWQnKX0pLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvX2NhcmQ6IHN0b3JlLmZpbmQoJ1JvbGUnLCB7dG9fY2FyZDogY2FyZC5nZXQoJ2lkJyl9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChtZW1iZXJzaGlwcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQobWVtYmVyc2hpcHMudG9fd29ya3NwYWNlLnRvQXJyYXkoKSwgbWVtYmVyc2hpcHMudG9fdmF1bHQudG9BcnJheSgpLCBtZW1iZXJzaGlwcy50b19jYXJkLnRvQXJyYXkoKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJldHVybiBwcm9taXNlIGZvciBhbGwgcmVxdWVzdHNcclxuICAgICAgICAgICAgcmV0dXJuIEVtYmVyLlJTVlAuaGFzaCh7XHJcbiAgICAgICAgICAgICAgICBzZWNyZXRzOiBzZWNyZXRzLFxyXG4gICAgICAgICAgICAgICAgbWVtYmVyc2hpcHM6IG1lbWJlcnNoaXBzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG5cclxuICAgICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0aW9uIChjdHJsLCBtb2RlbCkge1xyXG4gICAgICAgICAgICAvLyBzZXQgbW9kZWxcclxuICAgICAgICAgICAgY3RybC5zZXQoJ2NvbnRlbnQnLCBtb2RlbC5zZWNyZXRzKTtcclxuICAgICAgICAgICAgY3RybC5zZXQoJ21lbWJlcnNoaXBzJywgbW9kZWwubWVtYmVyc2hpcHMpO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0cmlldmUgd29ya3NwYWNlXHJcbiAgICAgICAgICAgIHZhciB3b3Jrc3BhY2UgPSB0aGlzLm1vZGVsRm9yKCdXb3Jrc3BhY2UnKTtcclxuICAgICAgICAgICAgdGhpcy5zZXQoJ3dvcmtzcGFjZScsIHdvcmtzcGFjZSk7XHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCd3b3Jrc3BhY2UnLCB3b3Jrc3BhY2UpO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0cmlldmUgdmF1bHRcclxuICAgICAgICAgICAgdmFyIHZhdWx0ID0gdGhpcy5tb2RlbEZvcignVmF1bHQnKTtcclxuICAgICAgICAgICAgdGhpcy5zZXQoJ3ZhdWx0JywgdmF1bHQpO1xyXG4gICAgICAgICAgICBjdHJsLnNldCgndmF1bHQnLCB2YXVsdCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZXRyaWV2ZSBjYXJkXHJcbiAgICAgICAgICAgIHZhciBjYXJkID0gdGhpcy5tb2RlbEZvcignQ2FyZCcpO1xyXG4gICAgICAgICAgICB0aGlzLnNldCgnY2FyZCcsIGNhcmQpO1xyXG4gICAgICAgICAgICBjdHJsLnNldCgnY2FyZCcsIGNhcmQpO1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0IGJyZWFkY3J1bWJzXHJcbiAgICAgICAgICAgIGN0cmwuc2V0KCdicmVhZGNydW1icycsXHJcbiAgICAgICAgICAgICAgICBWYXVsdGllci5CcmVhZGNydW1icy5jcmVhdGUoe3JvdXRlcjogdGhpcy5nZXQoJ3JvdXRlcicpLCBlbnZpcm9ubWVudDogdGhpcy5nZXQoJ2Vudmlyb25tZW50Jyl9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRIb21lKClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkV29ya3NwYWNlKClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkVmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDYXJkKClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhY3Rpb25zOiB7XHJcblxyXG4gICAgICAgICAgICBkb3dubG9hZEJsb2I6IGZ1bmN0aW9uIChzZWNyZXQpIHtcclxuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uTG9hZGVyLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgIHNlY3JldFxyXG4gICAgICAgICAgICAgICAgICAgIC5sb2FkQmxvYigpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkxvYWRlci5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc2VjcmV0LmdldCgnYmxvYi5maWxlZGF0YScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IHNlY3JldC5nZXQoJ2Jsb2IuZmlsZXR5cGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzZWNyZXQuZ2V0KCdibG9iLmZpbGVuYW1lJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnl0ZUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVBcnJheVtpXSA9IGRhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9iID0gbmV3IEJsb2IoW2J5dGVBcnJheS5idWZmZXJdLCB7dHlwZTogdHlwZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlQXMoYmxvYiwgbmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG5cclxuXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBkZWxldGVTZWNyZXQ6IGZ1bmN0aW9uIChzZWNyZXQpIHtcclxuICAgICAgICAgICAgICAgIFZhdWx0aWVyLmNvbmZpcm1Nb2RhbCh0aGlzLCAnQXJlIHlvdSBzdXJlPycsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXQoJ2NvbnRyb2xsZXIuY29udGVudCcpLnJlbW92ZU9iamVjdChzZWNyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gc2VjcmV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZWxldGVSZWNvcmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnWW91ciBzZWNyZXQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQuJywgJ3N1Y2Nlc3MnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNyZXQucm9sbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uTG9hZGVyLnByb21pc2UocHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbilcclxuO1xyXG5cclxuVmF1bHRpZXIuU2VjcmV0SW5kZXhDb250cm9sbGVyID0gRW1iZXIuQXJyYXlDb250cm9sbGVyLmV4dGVuZCh7XHJcbiAgICBpdGVtQ29udHJvbGxlcjogJ1NlY3JldEluZGV4SXRlbScsXHJcblxyXG4gICAgd29ya3NwYWNlOiBudWxsLFxyXG4gICAgdmF1bHQ6IG51bGwsXHJcbiAgICBjYXJkOiBudWxsXHJcbn0pO1xyXG5cclxuVmF1bHRpZXIuU2VjcmV0SW5kZXhJdGVtQ29udHJvbGxlciA9IEVtYmVyLk9iamVjdENvbnRyb2xsZXIuZXh0ZW5kKHtcclxufSk7XHJcblxyXG5WYXVsdGllci5TZWNyZXRJbmRleFZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0SW5kZXgnLFxyXG4gICAgbGF5b3V0TmFtZTogJ0xheW91dC9MYXlvdXRTdGFuZGFyZCdcclxufSk7XHJcblxyXG5cclxuVmF1bHRpZXIuU2VjcmV0SW5kZXhJdGVtTm90ZVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0SW5kZXhJdGVtTm90ZSdcclxufSk7XHJcblxyXG5WYXVsdGllci5TZWNyZXRJbmRleEl0ZW1QYXNzd29yZFZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7XHJcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0SW5kZXhJdGVtUGFzc3dvcmQnXHJcbn0pO1xyXG5cclxuXHJcblZhdWx0aWVyLlNlY3JldEluZGV4SXRlbUZpbGVWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldEluZGV4SXRlbUZpbGUnXHJcbn0pO1xyXG5cclxuVmF1bHRpZXIuU2VjcmV0SW5kZXhJdGVtQ29udHJvbHNWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xyXG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldEluZGV4SXRlbUNvbnRyb2xzJ1xyXG59KTtcclxuIiwiVmF1bHRpZXIuU2VjcmV0Q2FyZE5vZGVWaWV3ID0gRW1iZXIuVHJlZS5UcmVlTm9kZVZpZXcuZXh0ZW5kKHtcbiAgICB0ZW1wbGF0ZU5hbWU6ICdTZWNyZXQvU2VjcmV0TW92ZUNhcmROb2RlJyxcbiAgICBSYWRpbzogRW1iZXIuVmlldy5leHRlbmQoe1xuICAgICAgICB0YWdOYW1lOiBcImlucHV0XCIsXG4gICAgICAgIHR5cGU6IFwicmFkaW9cIixcbiAgICAgICAgYXR0cmlidXRlQmluZGluZ3M6IFsgIFwidHlwZVwiLCBcIm5hbWVcIiwgXCJ2YWx1ZVwiXSxcbiAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0KCdjb250cm9sbGVyJykuc2VuZCgnc2VsZWN0ZWQnLCB0aGlzLiQoKS52YWwoKSlcbiAgICAgICAgfVxuICAgIH0pLFxuICAgIGxvYWREYXRhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG59KTtcblxuVmF1bHRpZXIuU2VjcmV0VmF1bHROb2RlVmlldyA9IEVtYmVyLlRyZWUuVHJlZU5vZGVWaWV3LmV4dGVuZCh7XG4gICAgdGVtcGxhdGVOYW1lOiAnU2VjcmV0L1NlY3JldE1vdmVWYXVsdE5vZGUnLFxuXG4gICAgZ2V0U3ViTm9kZVZpZXdDbGFzczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVmF1bHRpZXIuU2VjcmV0Q2FyZE5vZGVWaWV3XG4gICAgfSxcblxuICAgIGxvYWREYXRhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdG9yZSA9IHRoaXMuZ2V0KCdjb250cm9sbGVyLnN0b3JlJyk7XG4gICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0KCdjb250ZW50LmlkJyk7XG4gICAgICAgIHZhciBub2RlcyA9IHN0b3JlXG4gICAgICAgICAgICAuZmluZCgnQ2FyZCcsIHt2YXVsdDogaWR9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldCgnYnJhbmNoJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZGVsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG59KTtcblxuVmF1bHRpZXIuU2VjcmV0TW92ZVJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKFxuICAgIFZhdWx0aWVyLldvcmtzcGFjZUtleXNNaXhpbixcbiAgICB7XG4gICAgICAgIGJlZm9yZU1vZGVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrV29ya3NwYWNlS2V5cygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24gKHNlY3JldCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzZWNyZXQ6IHNlY3JldC5pZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBtb2RlbDogZnVuY3Rpb24gKHBhcmFtcywgdHJhbnNpdGlvbikge1xuICAgICAgICAgICAgdmFyIHdvcmtzcGFjZSA9IHRoaXMubW9kZWxGb3IoJ1dvcmtzcGFjZScpO1xuICAgICAgICAgICAgdmFyIHN0b3JlID0gdGhpcy5nZXQoJ3N0b3JlJyk7XG5cbiAgICAgICAgICAgIHZhciBzZWNyZXQgPSBzdG9yZS5maW5kKCdTZWNyZXQnLCBwYXJhbXMuc2VjcmV0KTtcbiAgICAgICAgICAgIHNlY3JldFxuICAgICAgICAgICAgICAgIC50aGVuKHRoaXMuZ2V0KCdhdXRoJykuY2hlY2tQZXJtaXNzaW9ucyh0cmFuc2l0aW9uLCBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcGVybXMgPSBtb2RlbC5nZXQoJ3Blcm1zLnVwZGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGVybXNcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIHZhciB2YXVsdHMgPVxuICAgICAgICAgICAgICAgIHN0b3JlLlxuICAgICAgICAgICAgICAgICAgICBmaW5kKCdWYXVsdCcsIHt3b3Jrc3BhY2U6IHdvcmtzcGFjZS5nZXQoJ2lkJyl9KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldCgnYnJhbmNoJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBFbWJlci5SU1ZQLmhhc2goe1xuICAgICAgICAgICAgICAgIHNlY3JldDogc2VjcmV0LFxuICAgICAgICAgICAgICAgIHZhdWx0czogdmF1bHRzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0aW9uIChjdHJsLCBtb2RlbCkge1xuICAgICAgICAgICAgY3RybC5zZXQoJ2NvbnRlbnQnLCBtb2RlbC5zZWNyZXQpO1xuICAgICAgICAgICAgY3RybC5zZXQoJ3RyZWVOb2RlcycsIG1vZGVsLnZhdWx0cyk7XG5cbiAgICAgICAgICAgIC8vIHNldCBicmVhZGNydW1ic1xuICAgICAgICAgICAgY3RybC5zZXQoJ2JyZWFkY3J1bWJzJyxcbiAgICAgICAgICAgICAgICBWYXVsdGllci5CcmVhZGNydW1icy5jcmVhdGUoe3JvdXRlcjogdGhpcy5nZXQoJ3JvdXRlcicpLCBlbnZpcm9ubWVudDogdGhpcy5nZXQoJ2Vudmlyb25tZW50Jyl9KVxuICAgICAgICAgICAgICAgICAgICAuYWRkSG9tZSgpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRXb3Jrc3BhY2UoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkVmF1bHQoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2FyZCgpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRUZXh0KCdNb3ZlIHNlY3JldCcpXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFjdGlvbnM6IHtcblxuICAgICAgICAgICAgc2F2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0aGlzLmdldCgnY29udHJvbGxlci5jb250ZW50Jyk7XG4gICAgICAgICAgICAgICAgcmVjb3JkLnNldCgnY2FyZCcsIHRoaXMuZ2V0KCdjb250cm9sbGVyLnNlbGVjdGVkJykpO1xuICAgICAgICAgICAgICAgIHJlY29yZFxuICAgICAgICAgICAgICAgICAgICAuc2F2ZVJlY29yZCgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnWW91ciBzZWNyZXQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IG1vdmVkLicsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LmdvKC0xKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLm5vdGlmeSgnT29vdXBzISBTb21ldGhpbmcgd2VudCB3cm9uZy4nLCAnZXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG5WYXVsdGllci5TZWNyZXRNb3ZlQ29udHJvbGxlciA9IEVtYmVyLk9iamVjdENvbnRyb2xsZXIuZXh0ZW5kKHtcbiAgICBtb3ZlRGlzYWJsZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmdldCgnc2VsZWN0ZWQnKTtcbiAgICB9LnByb3BlcnR5KCdzZWxlY3RlZCcpLFxuICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICBicmVhZGNydW1iczogbnVsbCxcbiAgICBhY3Rpb25zOiB7XG4gICAgICAgIHNlbGVjdGVkOiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICB0aGlzLnNldCgnc2VsZWN0ZWQnLCB2YWwpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cblZhdWx0aWVyLlNlY3JldE1vdmVWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoe1xuICAgIHRlbXBsYXRlTmFtZTogJ1NlY3JldC9TZWNyZXRNb3ZlJyxcbiAgICBsYXlvdXROYW1lOiAnTGF5b3V0L0xheW91dFN0YW5kYXJkJyxcbiAgICBUcmVlOiBFbWJlci5UcmVlLlRyZWVWaWV3LmV4dGVuZCh7XG4gICAgICAgIGl0ZW1WaWV3Q2xhc3M6IFZhdWx0aWVyLlNlY3JldFZhdWx0Tm9kZVZpZXdcbiAgICB9KVxuXG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==